================================================================================
RADAR NARCISISTA â€“ CHECKLIST DE TESTES
================================================================================
VersÃ£o: 4.5
Ãšltima atualizaÃ§Ã£o: 03/12/2025 11:15 (UTC-5)

================================================================================
FLUXO 1 â€“ TESTE DE CLAREZA
================================================================================

â˜ Consigo responder as 18+1 perguntas sem erro
â˜ Vejo o resultado com zona global + eixos + categorias
â˜ A opÃ§Ã£o "Guardar como base" funciona sem erro
â˜ Depois de guardar, o Dashboard mostra recomendaÃ§Ãµes baseadas nesse teste
â˜ Posso refazer o teste e ver histÃ³rico

================================================================================
FLUXO 2 â€“ DIÃRIO
================================================================================

â˜ Consigo criar um diÃ¡rio normal (sem teste)
â˜ Consigo criar um diÃ¡rio vinculado Ã  base de clareza
â˜ O diÃ¡rio aparece na timeline em ordem correta
â˜ Se faÃ§o login/logout, os diÃ¡rios continuam lÃ¡
â˜ Posso editar um diÃ¡rio existente
â˜ Posso excluir um diÃ¡rio
â˜ A anÃ¡lise de IA funciona no diÃ¡rio

================================================================================
FLUXO 3 â€“ CHAT / COACH IA
================================================================================

â˜ Consigo abrir o chat logado
â˜ A IA fala como "Radar Narcisista", nÃ£o genÃ©rico
â˜ A IA usa contexto do teste (zona, risco) na resposta
â˜ A IA usa contexto do diÃ¡rio recente
â˜ Limite de mensagens por plano funciona
â˜ Mensagem de limite atingido aparece corretamente
â˜ BotÃ£o "Salvar no DiÃ¡rio" aparece apÃ³s 2+ mensagens
â˜ Modal de resumo permite editar texto, intensidade e tags
â˜ Resumo salvo aparece no DiÃ¡rio com badge "Resumo do Chat"
â˜ Modal de encerramento oferece opÃ§Ã£o de salvar resumo

================================================================================
FLUXO 4 â€“ FRONTPAGE / PLANOS
================================================================================

â˜ Homepage abre sem erro em aba anÃ´nima
â˜ As seÃ§Ãµes principais aparecem (hero, ferramentas, planos, FAQ)
â˜ BotÃ£o de cada plano leva para onde deveria
â˜ Planos sÃ£o carregados do banco (ou fallback funciona)
â˜ PromoÃ§Ãµes ativas aparecem com labels
â˜ PreÃ§o original riscado aparece quando hÃ¡ promoÃ§Ã£o

================================================================================
FLUXO 5 â€“ ADMIN / PLANOS
================================================================================

â˜ Consigo acessar /admin/planos como admin
â˜ Vejo lista de todos os planos (B2C e B2B)
â˜ Consigo editar nome, preÃ§o e limites de um plano
â˜ Consigo criar uma promoÃ§Ã£o com data de inÃ­cio/fim
â˜ Consigo ativar/desativar promoÃ§Ã£o
â˜ AlteraÃ§Ãµes refletem na frontpage

================================================================================
FLUXO 6 â€“ AUTENTICAÃ‡ÃƒO
================================================================================

â˜ Consigo criar conta nova
â˜ Consigo fazer login
â˜ Consigo fazer logout
â˜ Consigo recuperar senha
â˜ SessÃ£o persiste apÃ³s fechar navegador

================================================================================
FLUXO 7 â€“ LGPD / CONFIGURAÃ‡Ã•ES
================================================================================

â˜ Consigo exportar meus dados
â˜ Consigo solicitar exclusÃ£o de conta
â˜ Aceite de termos funciona
â˜ HistÃ³rico de aceites Ã© registrado

================================================================================
TESTES AUTOMATIZADOS (JEST)
================================================================================

â˜ npm run test passa sem erros
â˜ Cobertura mÃ­nima de 50%

================================================================================
TESTES DE BUILD
================================================================================

â˜ npm run build passa sem erros
â˜ Deploy na Vercel funciona
â˜ NÃ£o hÃ¡ erros de TypeScript

================================================================================
LEGENDA
================================================================================

â˜ = NÃ£o testado / Pendente
â˜‘ = Testado e funcionando
âœ— = Testado e com problema

================================================================================
TESTES REALIZADOS (29-30/11/2025)
================================================================================

FLUXO 5 â€“ ADMIN / PLANOS:
â˜‘ Consigo acessar /admin/planos como admin (CORRIGIDO)
â˜‘ Vejo lista de todos os planos (B2C e B2B)
â˜ Consigo editar nome, preÃ§o e limites de um plano
â˜‘ Consigo criar uma promoÃ§Ã£o com data de inÃ­cio/fim (RLS CORRIGIDO)
â˜ Consigo ativar/desativar promoÃ§Ã£o
â˜ AlteraÃ§Ãµes refletem na frontpage

FLUXO 6 â€“ AUTENTICAÃ‡ÃƒO:
â˜‘ Consigo fazer login com etailoffice@gmail.com
â˜‘ Admin Ã© reconhecido corretamente apÃ³s correÃ§Ã£o

TESTES DE BUILD:
â˜‘ npm run build passa sem erros (129 pÃ¡ginas)
â˜‘ Deploy na Vercel funciona
â˜‘ NÃ£o hÃ¡ erros de TypeScript

CORREÃ‡Ã•ES APLICADAS:
â˜‘ BotÃ£o "Config Menu" agora vai para /admin/menu-config (nÃ£o localhost)
â˜‘ DiÃ¡rio unificado - rotas duplicadas arquivadas em app/_archive/
â˜‘ Links do dashboard atualizados para rotas oficiais
â˜‘ Build passou com 129 pÃ¡ginas
â˜‘ Badge "Perfil de Clareza" implementado no DiÃ¡rio
â˜‘ Badge "Perfil de Clareza" + "Intenso" implementado na Timeline
â˜‘ Tipos JournalEntryType adicionados em types/database.ts

ROTAS OFICIAIS DO DIÃRIO:
â˜‘ /diario â†’ Lista de entradas
â˜‘ /diario/novo â†’ Criar entrada
â˜‘ /diario/[id] â†’ Visualizar entrada
â˜‘ /diario/[id]/editar â†’ Editar entrada
â˜‘ /diario/timeline â†’ Timeline de PadrÃµes

ETAPA 2 - TRIÃ‚NGULO CLAREZA â‡„ DIÃRIO â‡„ CHAT:
â˜ Fazer Teste de Clareza e salvar como base â†’ Deve criar entrada no diÃ¡rio
â˜ Entrada criada deve ter entry_type = 'clarity_baseline'
â˜ Entrada criada deve ter clarity_test_id preenchido
â˜ Chat deve receber contexto dos episÃ³dios recentes do diÃ¡rio
â˜ Chat deve receber perfil de clareza do usuÃ¡rio
â˜ Verificar logs no console do servidor (Vercel) para confirmar injeÃ§Ã£o de contexto
â˜ Acessar /diario/novo?from=clarity_result â†’ Deve prÃ©-preencher formulÃ¡rio
â˜ FormulÃ¡rio prÃ©-preenchido deve ter tÃ­tulo, tags e descriÃ§Ã£o do perfil de clareza

MIGRATION OBRIGATÃ“RIA (executar no Supabase):
ALTER TABLE public.journal_entries 
ADD COLUMN IF NOT EXISTS entry_type TEXT DEFAULT 'normal';

ALTER TABLE public.journal_entries 
ADD COLUMN IF NOT EXISTS clarity_test_id UUID REFERENCES public.clarity_tests(id);

ETAPA 3 - DIÃRIO + TIMELINE + DASHBOARD CONECTADOS AO TRIÃ‚NGULO:
â˜ /diario â†’ Entradas clarity_baseline devem mostrar badge "Perfil de Clareza"
â˜ /diario/timeline â†’ Entradas clarity_baseline devem mostrar badge "Perfil de Clareza"
â˜ /diario/timeline â†’ Entradas com mood_intensity >= 7 devem mostrar badge "Intenso"
â˜ /dashboard â†’ Deve mostrar dados reais de clareza (nÃ£o mock)
â˜ /dashboard â†’ Deve mostrar Ãºltimas entradas do diÃ¡rio reais
â˜ /dashboard â†’ EstatÃ­sticas (testes, episÃ³dios, mensagens) devem ser reais
â˜ Fluxo completo: Teste Clareza â†’ Salvar Base â†’ Ver entrada no DiÃ¡rio com badge
â˜ Fluxo completo: Teste Clareza â†’ Salvar Base â†’ Ver entrada na Timeline com badge

ETAPA 4 - CHAT â†’ DIÃRIO (SALVAR RESUMO):
â˜ API /api/chat/save-summary funciona (POST com auth)
â˜ BotÃ£o "Salvar no DiÃ¡rio" aparece no header do chat apÃ³s 2+ mensagens do usuÃ¡rio
â˜ Modal de resumo abre ao clicar no botÃ£o
â˜ Modal permite editar texto, ajustar intensidade (slider 0-10) e tags
â˜ Ao salvar, cria entrada no diÃ¡rio com entry_type = 'chat_summary'
â˜ Entrada salva aparece no /diario com badge "Resumo do Chat" (ğŸ’¬)
â˜ Entrada salva aparece no /diario/timeline com badge "Resumo do Chat"
â˜ Modal de encerramento de conversa oferece checkbox para salvar resumo
â˜ Se marcar checkbox e clicar "Continuar para salvar resumo", abre modal de resumo
â˜ Fluxo completo: Chat â†’ Salvar resumo â†’ Ver no DiÃ¡rio com badge

================================================================================
ETAPA 5 - EDITOR VISUAL DA FRONTPAGE:
================================================================================

â˜ Migration 007_frontpage_config.sql executada no Supabase
â˜ Tabela frontpage_config criada com dados seed
â˜ API /api/admin/frontpage-editor funciona (GET retorna configs)
â˜ API /api/admin/frontpage-editor funciona (PUT atualiza config)
â˜ /admin/frontpage-editor carrega sem erro
â˜ Editor de Hero permite editar tÃ­tulo, subtÃ­tulo e CTAs
â˜ Editor de FAQ permite adicionar/remover perguntas
â˜ Editor de Depoimentos permite adicionar/remover itens
â˜ BotÃ£o "Salvar" atualiza dados no banco
â˜ /admin/frontpage-visual carrega sem erro
â˜ Preview mostra alteraÃ§Ãµes em tempo real
â˜ Preview responsivo funciona (desktop/tablet/mobile)
â˜ AlteraÃ§Ãµes salvas refletem na frontpage real
â˜ Fallback funciona se tabela nÃ£o existir

================================================================================
ETAPA 6 - TRIÃ‚NGULO V2 (FILTROS + MAPA NO DASHBOARD):
================================================================================

FILTROS NO /diario:
â˜ Filtro "Todos" mostra todas as entradas
â˜ Filtro "Perfil de Clareza" mostra apenas entries clarity_baseline
â˜ Filtro "Resumo do Chat" mostra apenas entries chat_summary
â˜ Filtro "EpisÃ³dios Normais" mostra apenas entries normal ou sem tipo
â˜ Mensagem amigÃ¡vel quando filtro nÃ£o retorna resultados
â˜ Badges existentes continuam funcionando

FILTROS + LEGENDA NO /diario/timeline:
â˜ Filtros por entry_type funcionam igual ao /diario
â˜ Legenda do TriÃ¢ngulo aparece corretamente:
   - âœ¨ Perfil de Clareza
   - ğŸ’¬ Resumo do Chat
   - ğŸ”¥ EpisÃ³dio Intenso (â‰¥7)
â˜ Filtro nÃ£o quebra a timeline existente

CARD "ESTADO DO TRIÃ‚NGULO" NO /dashboard:
â˜ Card aparece na seÃ§Ã£o correta do dashboard
â˜ Coluna "Clareza" mostra se tem Perfil base salvo
â˜ Coluna "DiÃ¡rio" mostra contagem dos Ãºltimos 30 dias
â˜ Coluna "Chat" mostra contagem de resumos dos Ãºltimos 30 dias
â˜ Status "TriÃ¢ngulo Ativo" aparece quando os 3 lados tÃªm dados
â˜ Status "Incompleto" aparece quando falta algum lado
â˜ Mensagem explicativa indica o que falta completar
â˜ Card funciona em tema claro e escuro

================================================================================
ETAPA 7.3 - PLANO DE SEGURANÃ‡A NO TRIÃ‚NGULO:
================================================================================

API /api/safety-plan:
â˜ GET /api/safety-plan retorna plano do usuÃ¡rio autenticado
â˜ GET /api/safety-plan retorna status calculado (NOT_STARTED, IN_PROGRESS, READY)
â˜ POST /api/safety-plan cria novo plano
â˜ POST /api/safety-plan cria entrada no diÃ¡rio com entry_type='safety_plan'
â˜ PATCH /api/safety-plan atualiza plano existente
â˜ PATCH /api/safety-plan cria entrada no diÃ¡rio de atualizaÃ§Ã£o
â˜ API retorna 401 se nÃ£o autenticado
â˜ API retorna 409 se tentar criar plano que jÃ¡ existe

DASHBOARD - Card "Plano de SeguranÃ§a":
â˜ Card aparece no Dashboard
â˜ Card mostra status NOT_STARTED com cor cinza
â˜ Card mostra status IN_PROGRESS com cor amarela
â˜ Card mostra status READY com cor verde
â˜ Card tem link para /plano-seguranca
â˜ Card mostra contagem de contatos de emergÃªncia

DASHBOARD - Banner de Risco FÃ­sico:
â˜ Banner aparece se hasPhysicalRisk = true E plano nÃ£o estÃ¡ READY
â˜ Banner NÃƒO aparece se plano estÃ¡ READY
â˜ Banner tem cor vermelha se plano NOT_STARTED
â˜ Banner tem cor amarela se plano IN_PROGRESS
â˜ Banner tem link para /plano-seguranca

CHAT - DetecÃ§Ã£o de Risco FÃ­sico:
â˜ Digitar "ele me bateu" mostra banner de alerta
â˜ Digitar "me ameaÃ§ou" mostra banner de alerta
â˜ Digitar "medo de morrer" mostra banner de alerta
â˜ Banner tem link para /plano-seguranca
â˜ risk_alert Ã© criado no banco de dados
â˜ risk_alert tem source='chat', level='HIGH', category='PHYSICAL_VIOLENCE'

DIÃRIO - Badge "Plano de SeguranÃ§a":
â˜ Entradas com entry_type='safety_plan' mostram badge ğŸ›¡ï¸
â˜ Badge aparece no /diario
â˜ Badge aparece no /diario/timeline
â˜ Badge tem estilo vermelho

TESTE DE CLAREZA - risk_alert automÃ¡tico:
â˜ Ao salvar perfil com hasPhysicalRisk=true, cria risk_alert
â˜ risk_alert tem category='PHYSICAL_VIOLENCE'

FLUXO COMPLETO:
â˜ Criar Plano de SeguranÃ§a â†’ Ver entrada no DiÃ¡rio com badge ğŸ›¡ï¸
â˜ Atualizar Plano de SeguranÃ§a â†’ Ver nova entrada no DiÃ¡rio
â˜ Digitar frase de risco no Chat â†’ Ver banner + risk_alert criado
â˜ Fazer teste com risco fÃ­sico â†’ Ver risk_alert criado

================================================================================
ETAPA 7.4 â€“ QA TRIÃ‚NGULO + PLANO DE SEGURANÃ‡A (30/11/2025)
================================================================================

OBJETIVO: Validar que a ETAPA 7.3 funciona corretamente e nÃ£o abre buracos de seguranÃ§a.

T1 â€“ TESTE DE CLAREZA COM RISCO FÃSICO:
â˜ Teste com categoria fÃ­sica >= 30% marca has_physical_risk = true
â˜ risk_alert Ã© criado com source='clarity_test', category='PHYSICAL_VIOLENCE'
â˜ Dashboard mostra banner de risco fÃ­sico
â˜ Card do Plano de SeguranÃ§a reflete o status correto

T2 â€“ CHAT COM RISCO FÃSICO (REGEX):
â˜ Mensagem "ele me bateu" dispara detecÃ§Ã£o
â˜ Mensagem "me ameaÃ§ou" dispara detecÃ§Ã£o
â˜ Mensagem "medo de morrer" dispara detecÃ§Ã£o
â˜ Banner vermelho aparece no chat
â˜ risk_alert Ã© criado com source='chat', level='HIGH'
â˜ Resposta da IA nÃ£o quebra apÃ³s detecÃ§Ã£o

T3 â€“ PLANO DE SEGURANÃ‡A + DIÃRIO:
â˜ POST /api/safety-plan cria plano + entrada no diÃ¡rio
â˜ PATCH /api/safety-plan atualiza plano + entrada no diÃ¡rio
â˜ entry_type='safety_plan' estÃ¡ correto na entrada
â˜ Badge ğŸ›¡ï¸ aparece no /diario
â˜ Badge ğŸ›¡ï¸ aparece no /diario/timeline

T4 â€“ DASHBOARD (CARD + BANNERS):
â˜ Card mostra NOT_STARTED (cinza) quando nÃ£o hÃ¡ plano
â˜ Card mostra IN_PROGRESS (amarelo) quando plano incompleto
â˜ Card mostra READY (verde) quando plano completo
â˜ Banner vermelho aparece: hasPhysicalRisk + NOT_STARTED
â˜ Banner amarelo aparece: hasPhysicalRisk + IN_PROGRESS
â˜ Banner NÃƒO aparece: hasPhysicalRisk + READY
â˜ NÃ£o hÃ¡ crash se nÃ£o existir plano

T5 â€“ SEGURANÃ‡A / RLS:
â˜ /api/safety-plan filtra por user_id do usuÃ¡rio logado
â˜ /api/clarity/activate-profile filtra por user_id
â˜ /api/chat/route.ts (risk_alert) filtra por user_id
â˜ UsuÃ¡rio A nÃ£o consegue ver dados do UsuÃ¡rio B
â˜ Tabelas safety_plans, risk_alerts, journal_entries tÃªm RLS ativo

STATUS DOS TESTES (30/11/2025 16:45):
- T1: [X] PASS â€“ risk_alert criado corretamente, filtra por user_id
- T2: [X] PASS â€“ regex funciona, backend usa user autenticado
- T3: [X] PASS â€“ entry_type='safety_plan', diÃ¡rio criado
- T4: [X] PASS â€“ card/banners funcionam, sem crash
- T5: [X] PASS â€“ todas APIs filtram por user_id autenticado

RE-AUDITORIA (02/12/2025 18:55):
- T1: [X] PASS â€“ app/api/clarity/activate-profile/route.ts:291-317 cria risk_alert
- T2: [X] PASS â€“ app/chat/page.tsx:373 regex, :376-394 createRiskAlert, :1882-1915 banner
- T3: [X] PASS â€“ app/api/safety-plan/route.ts:78-115 createDiaryEntry com entry_type='safety_plan'
- T4: [X] PASS â€“ app/dashboard/page.tsx:1039-1172 card + banners condicionais
- T5: [X] PASS â€“ RLS em database/migrations/20241202_safety_plan_risk_alerts.sql:84-109
- BUILD: [X] PASS â€“ 170 pÃ¡ginas compiladas sem erros

================================================================================
ETAPA 12.1 â€“ INFRA DE CLIENTES PROFISSIONAIS
================================================================================

API /api/professional/clients:
â˜ GET retorna lista vazia se nÃ£o hÃ¡ clientes
â˜ GET retorna 401 se nÃ£o autenticado
â˜ GET retorna 403 se nÃ£o tem plano profissional
â˜ POST cria convite com cÃ³digo Ãºnico
â˜ POST retorna erro se limite de 20 clientes atingido

API /api/professional/clients/[id]:
â˜ GET retorna detalhes do cliente
â˜ GET retorna dados compartilhados se cliente ativo
â˜ PATCH atualiza notas do profissional
â˜ DELETE remove convite pendente
â˜ DELETE retorna erro se cliente nÃ£o Ã© pendente

Dashboard Profissional:
â˜ BotÃ£o "Convidar Cliente" abre modal
â˜ Modal gera cÃ³digo de convite
â˜ CÃ³digo aparece na tabela de clientes
â˜ BotÃ£o de remover convite funciona
â˜ Tabela mostra permissÃµes do cliente ativo

================================================================================
ETAPA 12.1.1 â€“ PÃGINA DE ACEITE DE CONVITE
================================================================================

PÃ¡gina /aceitar-convite:
â˜ UsuÃ¡rio nÃ£o logado vÃª opÃ§Ãµes login/cadastro
â˜ CÃ³digo da URL (?codigo=XXX) Ã© preservado apÃ³s login
â˜ UsuÃ¡rio logado pode digitar cÃ³digo manualmente
â˜ CÃ³digo invÃ¡lido mostra mensagem de erro clara
â˜ CÃ³digo jÃ¡ usado mostra mensagem apropriada

API /api/professional/invite/validate:
â˜ POST com cÃ³digo vÃ¡lido retorna dados do profissional
â˜ POST com cÃ³digo invÃ¡lido retorna erro 404
â˜ POST com cÃ³digo jÃ¡ aceito retorna erro 400
â˜ NÃ£o requer autenticaÃ§Ã£o

API /api/professional/invite/accept:
â˜ POST sem autenticaÃ§Ã£o retorna 401
â˜ POST com cÃ³digo vÃ¡lido atualiza status para 'active'
â˜ POST preenche client_id com usuÃ¡rio logado
â˜ POST salva permissÃµes escolhidas (share_*)
â˜ POST impede aceitar prÃ³prio convite
â˜ POST impede conexÃ£o duplicada com mesmo profissional

Fluxo completo:
â˜ Profissional cria convite â†’ cÃ³digo gerado
â˜ Cliente acessa /aceitar-convite?codigo=XXXXXXXX
â˜ Cliente nÃ£o logado â†’ login â†’ volta para aceite
â˜ Cliente logado â†’ valida â†’ escolhe permissÃµes â†’ confirma
â˜ Profissional vÃª cliente ativo no dashboard

UX/Ã‰tica:
â˜ Aviso "Radar NÃƒO substitui terapia/laudo" visÃ­vel
â˜ Cliente pode desmarcar permissÃµes sensÃ­veis
â˜ Tela de sucesso mostra o que foi autorizado

================================================================================
ETAPA 12.1.2 â€“ REVOGAÃ‡ÃƒO DE ACESSO PELO CLIENTE
================================================================================

PÃ¡gina /configuracoes/profissionais:
â˜ UsuÃ¡rio nÃ£o logado Ã© redirecionado para login
â˜ UsuÃ¡rio sem conexÃµes vÃª mensagem "Nenhum profissional conectado"
â˜ Lista mostra todos os profissionais conectados
â˜ Status visual correto (verde=ativo, amarelo=pausado, cinza=revogado)
â˜ Nome do profissional aparece corretamente

AÃ§Ã£o Revogar:
â˜ BotÃ£o "Revogar" aparece para conexÃµes ativas
â˜ Modal de confirmaÃ§Ã£o aparece antes de revogar
â˜ ApÃ³s revogar, status muda para 'revoked'
â˜ PermissÃµes (share_*) sÃ£o zeradas ao revogar
â˜ Profissional nÃ£o consegue mais ver dados do cliente

AÃ§Ã£o Pausar/Retomar:
â˜ BotÃ£o "Pausar" aparece para conexÃµes ativas
â˜ ApÃ³s pausar, status muda para 'paused'
â˜ BotÃ£o "Retomar" aparece para conexÃµes pausadas
â˜ ApÃ³s retomar, status volta para 'active'

EdiÃ§Ã£o de PermissÃµes:
â˜ BotÃ£o "PermissÃµes" expande painel de ediÃ§Ã£o
â˜ Toggles funcionam para cada share_*
â˜ AlteraÃ§Ãµes sÃ£o salvas imediatamente
â˜ Profissional vÃª apenas dados autorizados

API /api/client/connections:
â˜ GET retorna lista de conexÃµes do cliente
â˜ GET retorna 401 se nÃ£o autenticado
â˜ Dados do profissional sÃ£o enriquecidos (nome)

API /api/client/connections/[id]:
â˜ PATCH com action='revoke' funciona
â˜ PATCH com action='pause' funciona (sÃ³ se ativo)
â˜ PATCH com action='resume' funciona (sÃ³ se pausado)
â˜ PATCH com action='update_permissions' funciona
â˜ PATCH retorna 404 se conexÃ£o nÃ£o pertence ao cliente

================================================================================
ETAPA 12.2 â€“ RELATÃ“RIO BÃSICO POR CLIENTE
================================================================================

PÃ¡gina /dashboard-profissional/clientes/[id]:
â˜ Profissional nÃ£o logado Ã© redirecionado
â˜ Profissional sem plano profissional vÃª erro 403
â˜ Profissional vÃª relatÃ³rio do cliente ativo
â˜ Profissional nÃ£o vÃª relatÃ³rio de cliente revogado/pausado
â˜ Aviso Ã©tico aparece no topo do relatÃ³rio

MÃ³dulos do RelatÃ³rio:
â˜ MÃ³dulo Clareza aparece se share_clarity_tests = true
â˜ MÃ³dulo DiÃ¡rio aparece se share_journal_entries = true
â˜ MÃ³dulo Chat aparece se share_chat_summaries = true
â˜ MÃ³dulo SeguranÃ§a aparece se share_safety_plan = true
â˜ MÃ³dulo Alertas aparece se share_risk_alerts = true
â˜ MÃ³dulos nÃ£o autorizados NÃƒO aparecem

ConteÃºdo dos MÃ³dulos:
â˜ Clareza: total testes, Ãºltima zona, evoluÃ§Ã£o
â˜ DiÃ¡rio: total entradas, entradas/semana, intensidade mÃ©dia
â˜ Chat: total sessÃµes, sessÃµes recentes
â˜ SeguranÃ§a: plano existe? status
â˜ Alertas: total, nÃ£o resolvidos, recentes

ImpressÃ£o/PDF:
â˜ BotÃ£o "Imprimir / PDF" funciona
â˜ Layout de impressÃ£o estÃ¡ correto
â˜ Aviso Ã©tico aparece na versÃ£o impressa

API /api/professional/reports/[clientId]:
â˜ GET retorna relatÃ³rio completo
â˜ GET retorna 401 se nÃ£o autenticado
â˜ GET retorna 403 se nÃ£o tem plano profissional
â˜ GET retorna 403 se conexÃ£o nÃ£o estÃ¡ ativa
â˜ GET retorna 404 se cliente nÃ£o existe
â˜ Dados respeitam share_* do cliente

Dashboard Profissional:
â˜ BotÃ£o "RelatÃ³rio" aparece para clientes ativos
â˜ BotÃ£o leva para /dashboard-profissional/clientes/[id]
â˜ Clientes pendentes/revogados nÃ£o tÃªm botÃ£o de relatÃ³rio

================================================================================
ETAPA 12.3 â€“ EXPORTAÃ‡ÃƒO EM MASSA V1 (CSV)
================================================================================

BotÃ£o CSV na pÃ¡gina de relatÃ³rio:
â˜ BotÃ£o "CSV" aparece ao lado de "Imprimir / PDF"
â˜ Clique no botÃ£o inicia download do arquivo
â˜ Nome do arquivo: radar-cliente-[nome]-[data].csv

ConteÃºdo do CSV:
â˜ Header com nome do cliente e data
â˜ Aviso Ã©tico presente no arquivo
â˜ Resumo do cliente (nome, conexÃ£o, Ãºltima atividade)
â˜ PermissÃµes autorizadas listadas
â˜ MÃ³dulos aparecem apenas se share_* = true
â˜ Dados de clareza (se autorizado)
â˜ Dados de diÃ¡rio (se autorizado)
â˜ Dados de chat (se autorizado)
â˜ Dados de seguranÃ§a (se autorizado)
â˜ Dados de alertas (se autorizado)

SeguranÃ§a:
â˜ CSV sÃ³ Ã© gerado se profissional tem acesso ao cliente
â˜ Dados nÃ£o autorizados NÃƒO aparecem no CSV

================================================================================
ETAPA 13 â€“ INFRA WHITE-LABEL V1
================================================================================

PÃ¡gina /dashboard-profissional/marca:
â˜ PÃ¡gina carrega corretamente
â˜ Profissional nÃ£o logado Ã© redirecionado
â˜ Profissional sem plano profissional Ã© redirecionado

FormulÃ¡rio de marca:
â˜ Campo "Nome PÃºblico" funciona
â˜ Campo "Tagline" funciona
â˜ Cores predefinidas funcionam (clique seleciona)
â˜ Color picker funciona
â˜ Campo de cor hex aceita entrada manual
â˜ Campo "URL do Logo" funciona
â˜ Preview do logo aparece se URL vÃ¡lida
â˜ Toggle "Powered by Radar" funciona
â˜ Preview em tempo real atualiza

Salvar configuraÃ§Ã£o:
â˜ BotÃ£o "Salvar" envia dados para API
â˜ Mensagem de sucesso aparece
â˜ Dados sÃ£o persistidos (recarregar pÃ¡gina mantÃ©m valores)
â˜ ValidaÃ§Ã£o de cor hex funciona (rejeita formato invÃ¡lido)

API /api/professional/brand:
â˜ GET retorna configuraÃ§Ã£o existente
â˜ GET retorna defaults se nÃ£o existe
â˜ GET retorna 401 se nÃ£o autenticado
â˜ GET retorna 403 se nÃ£o tem plano profissional
â˜ POST cria nova configuraÃ§Ã£o
â˜ POST atualiza configuraÃ§Ã£o existente
â˜ POST valida formato de cor hex

Dashboard Profissional:
â˜ Link "Configurar Marca" aparece nos links rÃ¡pidos
â˜ Link leva para /dashboard-profissional/marca

================================================================================
MIGRATIONS PENDENTES (EXECUTAR NO SUPABASE):
================================================================================

1. 007_frontpage_config.sql
   - Cria tabela frontpage_config
   - Insere dados seed (hero, faq, testimonials, etc.)
   - Configura RLS para admins

2. 20241201_create_professional_clients.sql (ETAPA 12.1)
   - Cria tabela professional_clients
   - Campos: professional_id, client_id, status, invite_code, share_*, etc.
   - RLS: profissional vÃª seus clientes, cliente vÃª suas conexÃµes
   - Trigger para updated_at automÃ¡tico

3. 20241201_fix_professional_clients_nullable.sql (ETAPA 12.1.1)
   - Torna client_id nullable (necessÃ¡rio para convites pendentes)
   - Ajusta constraint unique
   - Adiciona policy para validaÃ§Ã£o pÃºblica de cÃ³digos

4. 20241201_create_professional_brand.sql (ETAPA 13)
   - Cria tabela professional_brand
   - Campos: display_name, brand_color, logo_url, tagline, show_radar_branding
   - RLS: profissional sÃ³ vÃª/edita sua marca
   - RLS: clientes podem ver marca do profissional conectado
   - Trigger para updated_at automÃ¡tico

================================================================================
BLOCO 14-20 â€“ TESTES PLANEJADOS
================================================================================

ETAPA 14 â€“ LOJA SIMPLIFICADA (CONCLUÃDO 01/12/2025):
âœ… PÃ¡gina /loja carrega sem erro
âœ… Add-ons aparecem com preÃ§os corretos
âœ… BotÃ£o de compra redireciona para Stripe (via /api/stripe/addon-checkout)
âœ… PÃ¡gina /loja/sucesso mostra confirmaÃ§Ã£o
â˜ Webhook do Stripe processa compra (pendente: criar webhook handler)
â˜ Add-on Ã© liberado apÃ³s pagamento (pendente: tabela user_addons)
NOTA: Checkout funciona, mas entrega do add-on requer webhook e tabela no banco

ETAPA 15 â€“ BETA COM 5 USUÃRIAS (CONCLUÃDO 01/12/2025):
âœ… /admin/beta-testers carrega (guia completo de recrutamento)
âœ… Migration 20241201_beta_testers.sql criada
âœ… API /api/beta/feedback funciona (POST/GET)
âœ… API /api/beta/events funciona (POST/GET)
âœ… Componente BetaFeedbackWidget criado
âœ… Hook useBetaTracking criado
â˜ Executar migration no Supabase (pendente)
â˜ Integrar BetaFeedbackWidget no layout principal
â˜ Testar fluxo completo de feedback

ETAPA 16 â€“ ORÃCULO V1 (CONCLUÃDO 01/12/2025):
âœ… /admin/oraculo carrega
âœ… 7 perguntas-chave sÃ£o respondidas
âœ… Dados agregados de: user_profiles, clarity_tests, journal_entries, beta_feedback, beta_events
âœ… Links para /admin/analytics, /admin/metricas, /admin/insights
âœ… Registrado em admin-features-registry.ts
â˜ Conectar com dados reais de MRR (Stripe)
â˜ Adicionar grÃ¡ficos de tendÃªncia

ETAPA 17 â€“ LIMPEZA DASHBOARDS (CONCLUÃDO 01/12/2025):
âœ… Dashboard principal da usuÃ¡ria: /dashboard (Trilha do HerÃ³i)
âœ… Dashboard profissional: /dashboard-profissional
âœ… Legados redirecionam: /dashboard-v2, /dashboard-premium
âœ… Links atualizados em 9 arquivos
âœ… Admin redireciona para /admin apÃ³s login
â˜ Testar navegaÃ§Ã£o completa em produÃ§Ã£o

ETAPA 18 â€“ LIMPEZA ADMIN (CONCLUÃDO 01/12/2025):
âœ… Menu admin reorganizado
âœ… OrÃ¡culo Ã© o PRIMEIRO item do menu
âœ… Curadoria Central logo apÃ³s
âœ… Termos Aceitos movido para o final
âœ… Ãcones adicionados ao AdminSidebar
â˜ Testar menu em produÃ§Ã£o

ETAPA 19 â€“ MANUAIS (CONCLUÃDO 01/12/2025):
âœ… docs/MANUAL-USUARIA.md existe e Ã© legÃ­vel
âœ… docs/MANUAL-PROFISSIONAL.md existe
âœ… docs/MANUAL-ADMIN.md existe
âœ… docs/MANUAL-DEV.md existe
âœ… docs/MANUAL-WHITELABEL.md existe
â˜ Revisar conteÃºdo com stakeholders

ETAPA 20 â€“ LÃ‚MPADA (CONCLUÃDO 01/12/2025):
âœ… LAMPADA-RADAR.txt existe na raiz
âœ… Estrutura de seÃ§Ãµes estÃ¡ clara (6 seÃ§Ãµes)
âœ… Bugs, ConfusÃµes, DecisÃµes, Ideias, DÃ­vidas, Notas
â˜ Revisar periodicamente e atualizar

ğŸ‰ BLOCO 14-20 CONCLUÃDO! MVP 1.0 PRONTO!

================================================================================
BLOCO 21-25 â€“ PÃ“S-MVP 1.0
================================================================================

ETAPA 21 â€“ BILLING SÃ“LIDO & ADD-ONS (CONCLUÃDO 01/12/2025):
âœ… Migration user_addons criada
âœ… Webhook Stripe processa add-ons
âœ… API /api/addons retorna add-ons do usuÃ¡rio
âœ… API /api/addons/consume consome crÃ©ditos
âœ… Build passou (161 pÃ¡ginas)
â˜ Executar migration no Supabase
â˜ Criar Price IDs no Stripe Dashboard
â˜ Testar fluxo completo de compra
â˜ Verificar registro em user_addons apÃ³s pagamento

ETAPA 22 â€“ ORÃCULO V2 (CONCLUÃDO 01/12/2025):
âœ… /api/oraculo-v2 responde com JSON vÃ¡lido
âœ… Migration oraculo_logs criada
âœ… BotÃ£o do OrÃ¡culo funciona em /admin e /admin/oraculo
âœ… Manuais atualizados (ADMIN, DEV)
âœ… docs/ORACULO-V2-PROMPT.md criado
â˜ Executar migration no Supabase
â˜ Testar chamada ao OrÃ¡culo em produÃ§Ã£o
â˜ Verificar logs em oraculo_logs

ETAPA 23 â€“ SEGURANÃ‡A (CONCLUÃDO 01/12/2025):
âœ… Rate limiting implementado (lib/rate-limit.ts)
âœ… Rate limiting aplicado em /api/oraculo-v2
âœ… Logger estruturado criado (lib/logger.ts)
âœ… /api/health retorna status do sistema
â˜ Aplicar rate limiting em outras rotas sensÃ­veis
â˜ Configurar Sentry para monitoramento de erros

ETAPA 24 â€“ MANUAIS (CONCLUÃDO 01/12/2025):
âœ… MANUAL-ADMIN.md atualizado (seÃ§Ã£o seguranÃ§a, links)
âœ… MANUAL-USUARIA.md atualizado (links rÃ¡pidos, FAQ)
âœ… MANUAL-PROFISSIONAL.md atualizado (links relacionados)
âœ… MANUAL-DEV.md atualizado (APIs, arquivos de projeto)
âœ… MANUAL-WHITELABEL.md atualizado (links para manuais)

ETAPA 25 â€“ QA (CONCLUÃDO 01/12/2025):
âœ… CHECKLIST-POS-MVP.md criado
âœ… LÃ‚MPADA-RADAR.txt atualizado
âœ… DocumentaÃ§Ã£o final consolidada
â˜ Executar migrations no Supabase
â˜ Criar Price IDs no Stripe
â˜ Testar fluxos principais manualmente

ğŸ‰ BLOCO 21-25 CONCLUÃDO!

================================================================================
BLOCO 26-30 â€“ ORÃCULO V2 MULTIPERFIL + INFRA COMUNICAÃ‡ÃƒO IA
================================================================================

ETAPA 26 â€“ TEMPLATE DE RESUMO + CHECKLIST + REGRAS (CONCLUÃDO 01/12/2025):
âœ… docs/FORMATO-RESUMO-ETAPAS.md atualizado (v2.0)
âœ… docs/CHECKLIST-RESUMO-IA.md criado
âœ… docs/PATCHES-ORACULO-COMPLETO.md criado
âœ… scripts/validar-resumo-ia.ts criado
âœ… Build verificado

ETAPA 27 â€“ ORACULO_V2_CORE (CONCLUÃDO 01/12/2025):
âœ… lib/oraculo-core.ts criado
âœ… Prompts por perfil implementados
âœ… /api/oraculo-v2 refatorado
âœ… docs/ORACULO-CORE.md criado
âœ… Build passou: 163 pÃ¡ginas
â˜ Testar chamadas ao core em produÃ§Ã£o

ETAPA 28 â€“ INFRA MULTIPERFIL (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-settings.sql criado
âœ… lib/oraculo-settings.ts criado
âœ… /api/oraculo-v2 integrado com verificaÃ§Ã£o de limites
âœ… Build passou: 163 pÃ¡ginas
â˜ Executar migration no Supabase
â˜ Testar verificaÃ§Ã£o de limites em produÃ§Ã£o
â˜ Testar bloqueio quando limite atingido

ETAPA 29 â€“ EXPOR ORÃCULO V2 (CONCLUÃDO 01/12/2025):
âœ… components/OraculoMultiperfil.tsx criado
âœ… components/OraculoHint.tsx criado
âœ… Build passou: 163 pÃ¡ginas
â˜ Testar OrÃ¡culo como profissional (apÃ³s habilitar no Supabase)
â˜ Testar OrÃ¡culo como whitelabel (apÃ³s habilitar no Supabase)
â˜ Verificar limites por perfil em produÃ§Ã£o

ETAPA 30 â€“ INTEGRAÃ‡ÃƒO GERADOR DE SAAS + QA (CONCLUÃDO 01/12/2025):
âœ… docs/ORACULO-CORE-SAAS.md criado
âœ… lib/__tests__/oraculo-core.test.ts criado
âœ… Build passou: 163 pÃ¡ginas
ğŸ‰ BLOCO 26-30 CONCLUÃDO!

â˜ Executar testes: npx jest lib/__tests__/oraculo-core.test.ts
â˜ Executar migration no Supabase
â˜ Testar OrÃ¡culo em produÃ§Ã£o

================================================================================
ETAPAS 31-44 â€“ ORÃCULO MULTI-INSTÃ‚NCIA + ANALYTICS
================================================================================

ETAPA 31-35 â€“ INFRAESTRUTURA MULTI-INSTÃ‚NCIA (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-instances.sql criado
âœ… lib/oraculo-instances.ts criado
âœ… app/admin/oraculo-instances/page.tsx criado
âœ… app/admin/oraculo-instances/[id]/page.tsx criado
âœ… APIs de instÃ¢ncias e mÃ©tricas criadas
âœ… Build passou: 166 pÃ¡ginas

ETAPA 36 â€“ SISTEMA DE API KEYS (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-api-keys.sql criado
âœ… lib/oraculo-api-keys.ts criado
âœ… API /api/admin/oraculo-instances/[id]/keys criada
âœ… UI de gerenciamento de keys
âœ… Build passou: 166 pÃ¡ginas

ETAPA 37 â€“ SISTEMA DE WEBHOOKS (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-webhooks.sql criado
âœ… lib/oraculo-webhooks.ts criado
âœ… API /api/admin/oraculo-instances/[id]/webhooks criada
âœ… Assinatura HMAC-SHA256
âœ… Build passou: 166 pÃ¡ginas

ETAPA 38 â€“ SISTEMA DE BILLING (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-billing.sql criado
âœ… lib/oraculo-billing.ts criado
âœ… API /api/admin/oraculo-instances/[id]/billing criada
âœ… Planos: Free, Starter, Pro, Enterprise
âœ… Build passou: 166 pÃ¡ginas

ETAPA 39 â€“ LOGS DETALHADOS (CONCLUÃDO 01/12/2025):
âœ… database/migrate-oraculo-usage-logs.sql criado
âœ… lib/oraculo-usage-logs.ts criado
âœ… API /api/admin/oraculo-instances/[id]/logs criada
âœ… IntegraÃ§Ã£o na API pÃºblica
âœ… Build passou: 166 pÃ¡ginas

ETAPA 40 â€“ DOCUMENTAÃ‡ÃƒO INTERATIVA (CONCLUÃDO 01/12/2025):
âœ… app/docs/api/page.tsx criado
âœ… Exemplos em JavaScript, Python, cURL, PHP
âœ… Playground para testar endpoints
âœ… DocumentaÃ§Ã£o de webhooks
âœ… Build passou: 167 pÃ¡ginas

ETAPA 41 â€“ TESTES AUTOMATIZADOS (CONCLUÃDO 01/12/2025):
âœ… lib/__tests__/oraculo-instances.test.ts criado
âœ… lib/__tests__/oraculo-api-keys.test.ts criado
âœ… lib/__tests__/oraculo-billing.test.ts criado
âœ… vitest.config.ts e vitest.setup.ts criados
âœ… Scripts de teste atualizados no package.json
âœ… Build passou: 167 pÃ¡ginas

ETAPA 42 â€“ DASHBOARD ANALYTICS (CONCLUÃDO 01/12/2025):
âœ… app/admin/analytics-dashboard/page.tsx criado
âœ… 6 cards de mÃ©tricas com variaÃ§Ã£o percentual
âœ… GrÃ¡ficos: Ã¡rea, barras, pizza, horizontal
âœ… Filtro de perÃ­odo: 7, 30, 90 dias
âœ… Tabela detalhada por instÃ¢ncia
âœ… Build passou: 170 pÃ¡ginas

ETAPA 43 â€“ ALERTAS AUTOMÃTICOS (CONCLUÃDO 01/12/2025):
âœ… lib/oraculo-alerts.ts criado
âœ… database/migrate-oraculo-alerts.sql criado
âœ… Tipos: quota_warning, quota_exceeded, error_spike, etc.
âœ… Severidades: info, warning, error, critical
âœ… Build passou: 170 pÃ¡ginas

ETAPA 44 â€“ EXPORTAÃ‡ÃƒO DE RELATÃ“RIOS (CONCLUÃDO 01/12/2025):
âœ… app/admin/analytics-dashboard/export/page.tsx criado
âœ… Formatos: CSV, JSON, PDF
âœ… Tipos: queries, tokens, instances, billing, full
âœ… Download automÃ¡tico
âœ… Build passou: 170 pÃ¡ginas

ğŸ‰ BLOCO 40-44 CONCLUÃDO!

MIGRATIONS PENDENTES (executar no Supabase):
â˜ migrate-oraculo-instances.sql
â˜ migrate-oraculo-api-keys.sql
â˜ migrate-oraculo-webhooks.sql
â˜ migrate-oraculo-billing.sql
â˜ migrate-oraculo-usage-logs.sql
â˜ migrate-oraculo-alerts.sql

TESTES PENDENTES:
â˜ npm run test (vitest)
â˜ Testar criaÃ§Ã£o de instÃ¢ncia whitelabel
â˜ Testar API pÃºblica com API key
â˜ Testar webhooks com assinatura
â˜ Testar billing e limites
â˜ Testar exportaÃ§Ã£o de relatÃ³rios

================================================================================
BLOCO 26-30 - ORÃCULO V2 MULTIPERFIL
================================================================================

[ETAPA 26] TEMPLATE DE RESUMO + CHECKLIST + REGRAS DE LINGUAGEM
- [ ] Verificar docs/FORMATO-RESUMO-ETAPAS.md estÃ¡ na v3.0
- [ ] Verificar docs/REGRAS-COMUNICACAO-IA.md estÃ¡ na v2.0
- [ ] Verificar docs/CHECKLIST-RESUMO-IA.md estÃ¡ na v2.0
- [ ] Testar script: npx ts-node scripts/validar-resumo-ia.ts "texto com opcional"
  - Deve retornar INVÃLIDO
- [ ] Testar script: npx ts-node scripts/validar-resumo-ia.ts "texto sem palavras proibidas"
  - Deve retornar VÃLIDO (se tiver seÃ§Ãµes obrigatÃ³rias)

[ETAPA 27] ORACULO_V2_CORE (nÃºcleo reutilizÃ¡vel)
- [ ] Verificar lib/oraculo-core.ts existe e exporta funÃ§Ãµes
- [ ] Verificar /api/oraculo-v2 usa o core
- [ ] Testar chamada ao OrÃ¡culo V2 como admin
- [ ] Verificar resposta JSON com: modo, risco, titulo_curto, resposta_principal

[ETAPA 28] INFRA MULTIPERFIL
- [ ] Verificar tabela oraculo_settings existe
- [ ] Verificar lib/oraculo-settings.ts existe
- [ ] Testar limites por plano (daily_limit, weekly_limit, monthly_limit)
- [ ] Testar flag enabled por perfil

[ETAPA 29] ORÃCULO V2 PARA NOVOS PERFIS
- [ ] Verificar componente OraculoHintProfissional.tsx
- [ ] Verificar componente OraculoHintWhitelabel.tsx
- [ ] Testar OrÃ¡culo no dashboard-profissional
- [ ] Verificar respeito aos limites

[ETAPA 30] INTEGRAÃ‡ÃƒO COM GERADOR DE SAAS
- [ ] Verificar docs/ORACULO-CORE-SAAS.md existe
- [ ] Verificar testes unitÃ¡rios do ORACULO_V2_CORE
- [ ] Testar cenÃ¡rios com roles diferentes

================================================================================
FLUXO GERADOR-SAAS â€“ FASE 1
================================================================================

[TESTE VISUAL] PÃ¡gina /admin/gerador-saas
- [ ] Acessar /admin/gerador-saas como admin
- [ ] Verificar que a pÃ¡gina carrega sem erros
- [ ] Verificar tÃ­tulo "Gerador de SaaS" aparece
- [ ] Verificar cards explicativos (SAAS-TEMATICO e CORE-BRANCO)
- [ ] Verificar lista de projetos gerados (pode estar vazia)

[TESTE CRIAÃ‡ÃƒO] BotÃµes de SimulaÃ§Ã£o
- [ ] Clicar em "Criar Novo Projeto"
- [ ] Preencher nome do projeto
- [ ] Selecionar tipo SAAS-TEMATICO
- [ ] Preencher descriÃ§Ã£o
- [ ] Selecionar mÃ³dulos
- [ ] Clicar em "Criar Projeto"
- [ ] Verificar que projeto aparece na lista com status "Criando..."
- [ ] Aguardar status mudar para "Pronto"

[TESTE AÃ‡Ã•ES] AÃ§Ãµes por Projeto
- [ ] Clicar em "Ver instruÃ§Ãµes" - modal deve abrir
- [ ] Clicar em "Copiar git clone" - deve copiar para clipboard
- [ ] Clicar em "Baixar ZIP" - deve iniciar download (simulado)
- [ ] Clicar em "Remover" - deve pedir confirmaÃ§Ã£o e remover

[TESTE CORE-BRANCO] CriaÃ§Ã£o de Core Branco
- [ ] Repetir fluxo de criaÃ§Ã£o com tipo CORE-BRANCO
- [ ] Verificar que projeto aparece com Ã­cone diferente
- [ ] Verificar que origem mostra "RADAR-CORE@BLOCO-45"

================================================================================
FIM DO CHECKLIST DE TESTES
================================================================================
