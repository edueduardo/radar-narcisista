================================================================================
RADAR NARCISISTA ‚Äì ROADMAP
================================================================================
Vers√£o: 4.2
√öltima atualiza√ß√£o: 01/12/2025 21:00 (UTC-5)

================================================================================
STATUS GERAL
================================================================================

üöÄ BLOCO 26-30 EM ANDAMENTO!
Vers√£o atual: MVP 1.0.29 (ETAPA 29 CONCLU√çDA)
Objetivo desta fase: Or√°culo V2 Multiperfil + Infra de Comunica√ß√£o IA

================================================================================
PRIORIDADE AGORA (N√ÉO MEXER NA ORDEM SEM AUTORIZA√á√ÉO)
================================================================================

1) ‚úÖ Sistema de Planos Administr√°veis (CONCLU√çDO 29/11/2025)
   - Tabelas billing_plans e billing_plan_promotions
   - Tela /admin/planos
   - Integra√ß√£o homepage e /planos
   - Promo√ß√µes com labels e datas

2) ‚úÖ Fechar Di√°rio (CONCLU√çDO 29/11/2025)
   - Rotas unificadas: /diario, /diario/novo, /diario/timeline
   - Conectado com Teste de Clareza (entry_type, clarity_test_id)
   - Timeline funcional com badges
   - Badges "Perfil de Clareza" e "Intenso"

3) ‚úÖ Fechar Chat (CONCLU√çDO 30/11/2025)
   - Coach IA usando contexto do teste ‚úÖ
   - Coach IA usando √∫ltimos di√°rios ‚úÖ
   - Limites por plano funcionando ‚úÖ
   - Chat ‚Üí Di√°rio (salvar resumo) ‚úÖ

4) ‚úÖ Editor Visual da Frontpage (CONCLU√çDO 30/11/2025)
   - Promo√ß√µes din√¢micas funcionando ‚úÖ
   - Planos lendo do banco ‚úÖ
   - Editor por formul√°rios (/admin/frontpage-editor) ‚úÖ
   - Editor visual com preview (/admin/frontpage-visual) ‚úÖ
   - Hook useFrontpageConfig.ts criado ‚úÖ
   - Migration 007_frontpage_config.sql criada ‚úÖ
   - PENDENTE: Rodar migration no Supabase

5) ‚úÖ Tri√¢ngulo V2 - Filtros + Mapa no Dashboard (CONCLU√çDO 30/11/2025)
   - Filtros por entry_type no /diario ‚úÖ
   - Filtros por entry_type no /diario/timeline ‚úÖ
   - Legenda do Tri√¢ngulo na Timeline (‚ú®, üí¨, üî•) ‚úÖ
   - Card "Estado do Tri√¢ngulo" no /dashboard ‚úÖ
   - Status "Tri√¢ngulo Ativo" ou "Incompleto" ‚úÖ
   - PENDENTE-V2: Auto-resumo IA no Chat

6) ‚úÖ ETAPA 7.3 - Plano de Seguran√ßa no Tri√¢ngulo (CONCLU√çDO 30/11/2025 15:20)
   - API REST /api/safety-plan (GET, POST, PATCH) ‚úÖ
   - Card "Plano de Seguran√ßa" no Dashboard ‚úÖ
   - Banner de risco f√≠sico no Dashboard ‚úÖ
   - Detec√ß√£o de risco f√≠sico no Chat (regex) ‚úÖ
   - Banner de alerta no Chat ‚úÖ
   - Cria√ß√£o de risk_alert via Chat ‚úÖ
   - Badge üõ°Ô∏è no Di√°rio e Timeline ‚úÖ
   - risk_alert autom√°tico no Teste de Clareza ‚úÖ
   - Tipo 'safety_plan' no JournalEntryType ‚úÖ
   - Build passou: 134 p√°ginas ‚úÖ

7) ‚úÖ ETAPA 7.4 - QA Tri√¢ngulo + Plano de Seguran√ßa (CONCLU√çDO 30/11/2025 16:45)
   - T1: Teste de Clareza com risco f√≠sico ‚Üí PASS ‚úÖ
   - T2: Chat com risco f√≠sico (regex) ‚Üí PASS ‚úÖ
   - T3: Plano de Seguran√ßa + Di√°rio ‚Üí PASS ‚úÖ
   - T4: Dashboard Card/Banners ‚Üí PASS ‚úÖ
   - T5: Seguran√ßa/RLS (user_id) ‚Üí PASS ‚úÖ
   - Todas APIs filtram por user_id autenticado ‚úÖ
   - Nenhum bug encontrado ‚úÖ
   - Build passou: 134 p√°ginas ‚úÖ

8) üîÑ ETAPA 8 - FanPage Viva + Camada Comercial (EM ANDAMENTO)
   OBJETIVO: Transformar frontpage em organismo vivo com curadoria
   
   ‚úÖ ETAPA 8.1 - Infraestrutura de Banco (CONCLU√çDO 30/11/2025 18:25)
   - [x] Tabela content_sources (fontes externas confi√°veis)
   - [x] Tabela content_items (conte√∫dos publicados)
   - [x] Tabela content_suggestions (sugest√µes IA + manual)
   - [x] Tabela content_collections (Radar Academy)
   - [x] Tabela content_collection_items (ponte N:N)
   - [x] Tabela content_insights (Radar em N√∫meros)
   - [x] RLS: leitura p√∫blica s√≥ para visibility='public'
   - [x] Triggers updated_at autom√°ticos
   - [x] Seed data: 6 m√©tricas + 3 FAQs iniciais
   - [x] Migration: 20241130_create_content_system.sql
   - [x] Build passou: 134 p√°ginas
   
   ‚úÖ ETAPA 8.2 - APIs Admin + IA Curadora (CONCLU√çDO 30/11/2025 19:15)
   - [x] /api/admin/content/items (GET, POST)
   - [x] /api/admin/content/items/[id] (GET, PATCH, DELETE)
   - [x] /api/admin/content/suggestions (GET, POST)
   - [x] /api/admin/content/suggestions/[id] (GET, PATCH, DELETE)
   - [x] /api/admin/content/collections (GET, POST)
   - [x] /api/admin/content/collections/[id] (GET, PATCH, DELETE)
   - [x] /api/admin/content/collections/[id]/items (GET, POST, PATCH, DELETE)
   - [x] /api/admin/content/insights/recompute (GET, POST)
   - [x] /api/admin/content/curadoria/ia-sugerir (POST)
   - [x] lib/content-insights.ts (7 m√©tricas calculadas)
   - [x] IA Curadora usando Groq/OpenAI existente
   - [x] Padr√£o admin: requireAdminAPI de lib/admin-auth.ts
   
   ‚úÖ ETAPA 8.3 - P√°ginas Admin de Curadoria (CONCLU√çDO 30/11/2025 20:15)
   - [x] /admin/conteudos/sugestoes (gerenciar sugest√µes IA Curadora)
   - [x] /admin/conteudos/publicados (gerenciar content_items)
   - [x] /admin/conteudos/colecoes (gerenciar trilhas/cole√ß√µes)
   - [x] /admin/conteudos/insights (Radar em N√∫meros - m√©tricas)
   - [x] admin-features-registry.ts atualizado com 4 novos IDs
   - [x] Build passou: 143 p√°ginas
   
   ‚úÖ ETAPA 8.4 - Blocos Din√¢micos na Frontpage (CONCLU√çDO 30/11/2025 20:45)
   - [x] Hero com CTAs comerciais (j√° existe)
   - [x] Planos e Pre√ßos (j√° existe, integrado com billing_plans)
   - [x] Radar em N√∫meros (content_insights via API)
   - [x] FAQ din√¢mico (content_items type='faq')
   - [x] Radar no Mundo (content_items source_type='external_*')
   - [x] Radar Academy (content_collections)
   - [x] lib/frontpage-content.ts (fun√ß√µes de busca)
   - [x] app/api/frontpage/content/route.ts (API p√∫blica)
   - [x] 5 componentes em components/frontpage/
   - [x] app/page.tsx integrado com DynamicSections
   
   NOTA: Se√ß√µes s√≥ aparecem se houver dados no banco. Rodar migration primeiro!

   ‚úÖ ETAPA 9 - Painel de Curadoria + Sem√°foro de Edi√ß√£o (CONCLU√çDO 30/11/2025 21:15)
   - [x] lib/curadoria-config.ts (get/update config)
   - [x] /api/admin/curadoria/config (GET/PATCH)
   - [x] components/admin/EditSemaforoBadge.tsx (badge + card + explanation)
   - [x] /admin/curadoria (painel central)
   - [x] Sem√°foro aplicado em 4 p√°ginas admin
   - [x] admin-features-registry.ts atualizado
   - [x] Build passou: 145 p√°ginas

   ‚úÖ ETAPA 10 - Infra de Planos, Fam√≠lias e M√≥dulos de Dashboard (CONCLU√çDO 30/11/2025 21:45)
   - [x] lib/plan-taxonomy.ts (PlanFamily, PLAN_TAXONOMY, fun√ß√µes auxiliares)
   - [x] lib/plan-dashboard-modules.ts (DashboardModuleId, DASHBOARD_MODULES)
   - [x] /admin/planos com SemaforoCard amarelo (zona sens√≠vel)
   - [x] Prepara√ß√£o para ETAPAS 11-13 (dashboards por plano)
   - [x] Build passou: 145 p√°ginas

   ‚úÖ ETAPA 11 - Redesenho do Dashboard do Usu√°rio - INFRA (CONCLU√çDO 30/11/2025 22:10)
   - [x] lib/plan-dashboard-modules.ts atualizado com heroStep e minPlanLevel
   - [x] lib/dashboard-user-layout.ts criado
   - [x] Fun√ß√µes: buildUserDashboardLayout, getWelcomeMessage, getNextSuggestedAction
   - [x] Trilha do her√≥i: 5 etapas (Entender, Registrar, Conversar, Proteger, Recursos)
   - [x] Backup: app/dashboard/page.BACKUP_ETAPA11.tsx
   - [x] Build passou: 145 p√°ginas
   
   NOTA: A infra est√° pronta. O visual do /dashboard pode ser atualizado
   incrementalmente usando buildUserDashboardLayout() sem quebrar nada.

================================================================================
PR√ìXIMAS ETAPAS (PRIORIDADE)
================================================================================

‚úÖ ETAPA 11.1 - Aplicar trilha visual no /dashboard (CONCLU√çDO 30/11/2025 23:55)
   - [x] Timeline horizontal dos 5 passos (Entender, Registrar, Conversar, Proteger, Recursos)
   - [x] Cards de m√≥dulos liberados/bloqueados por plano
   - [x] Pr√≥xima a√ß√£o sugerida baseada no estado do usu√°rio
   - [x] Componente HeroModuleCard para renderizar m√≥dulos
   - [x] Integra√ß√£o com buildUserDashboardLayout() e getWelcomeMessage()
   - [x] Build passou: 145 p√°ginas
   
‚úÖ ETAPA 11.2 - Ajustes finos do dashboard (CONCLU√çDO 01/12/2025 00:15)
   - [x] Heur√≠stica inteligente do "passo atual" (getCurrentHeroStep)
   - [x] Badge "Voc√™ est√° aqui" no passo atual
   - [x] Passos completados com ‚úì verde
   - [x] Microc√≥pias refinadas (linguagem acolhedora)
   - [x] Mobile: scroll horizontal melhorado
   - [x] Build passou: 145 p√°ginas
   
‚úÖ ETAPA 12 - Dashboard Profissional V1 (CONCLU√çDO 01/12/2025 00:45)
   - [x] Nova rota: /dashboard-profissional
   - [x] Gating por plano (s√≥ 'profissional' acessa)
   - [x] Tela "√Årea Exclusiva" para n√£o-autorizados
   - [x] Header com boas-vindas e badge do plano
   - [x] Vis√£o geral (4 cards de m√©tricas)
   - [x] Painel de clientes (estrutura V1, sem dados reais)
   - [x] Pr√≥ximos passos (roadmap do produto)
   - [x] Link "Acessar meu painel" em /profissional
   - [x] Suporte a tema claro/escuro
   - [x] Build passou: 146 p√°ginas

‚úÖ ETAPA 12.1 - Infra de Clientes Profissionais (CONCLU√çDO 01/12/2025 01:15)
   - [x] Migration: 20241201_create_professional_clients.sql
   - [x] Tabela professional_clients com RLS completo
   - [x] API: /api/professional/clients (GET, POST)
   - [x] API: /api/professional/clients/[id] (GET, PATCH, DELETE)
   - [x] Dashboard consome dados reais da API
   - [x] Modal de cria√ß√£o de convite funcional
   - [x] Build passou: 147 p√°ginas

‚úÖ ETAPA 12.1.1 - P√°gina de Aceite de Convite (CONCLU√çDO 01/12/2025 02:00)
   - [x] Nova rota: /aceitar-convite (suporta ?codigo=XXXXXXXX)
   - [x] API: /api/professional/invite/validate (POST)
   - [x] API: /api/professional/invite/accept (POST)
   - [x] Migration de corre√ß√£o: 20241201_fix_professional_clients_nullable.sql
   - [x] Fluxo completo: n√£o logado ‚Üí login/cadastro ‚Üí aceite
   - [x] Cliente escolhe permiss√µes (share_*)
   - [x] Avisos √©ticos: "Radar N√ÉO substitui terapia/laudo"
   - [x] Build passou: 150 p√°ginas
   
   ‚ö†Ô∏è PENDENTE: Rodar AMBAS migrations no Supabase:
     1. 20241201_create_professional_clients.sql
     2. 20241201_fix_professional_clients_nullable.sql

‚úÖ ETAPA 12.1.2 - Revoga√ß√£o de Acesso pelo Cliente (CONCLU√çDO 01/12/2025 03:30)
   - [x] P√°gina /configuracoes/profissionais
   - [x] Lista de profissionais conectados com status visual
   - [x] Bot√£o para revogar acesso (status ‚Üí 'revoked')
   - [x] Bot√£o para pausar temporariamente (status ‚Üí 'paused')
   - [x] Bot√£o para retomar acesso (status ‚Üí 'active')
   - [x] Edi√ß√£o de permiss√µes individuais (share_*)
   - [x] API: /api/client/connections (GET)
   - [x] API: /api/client/connections/[id] (PATCH)
   - [x] Link na p√°gina /configuracoes
   - [x] Build passou: 152 p√°ginas

‚úÖ ETAPA 12.2 - Relat√≥rio B√°sico por Cliente V1 (CONCLU√çDO 01/12/2025 03:30)
   - [x] P√°gina /dashboard-profissional/clientes/[id]
   - [x] API: /api/professional/reports/[clientId] (GET)
   - [x] M√≥dulos baseados em share_*:
     - Clareza: total, √∫ltima zona, evolu√ß√£o
     - Di√°rio: total, entradas/semana, intensidade m√©dia
     - Chat: total sess√µes, recentes
     - Seguran√ßa: plano existe?
     - Alertas: total, n√£o resolvidos
   - [x] Bot√£o "Imprimir / PDF" via print do navegador
   - [x] Aviso √©tico no topo do relat√≥rio
   - [x] Bot√£o "Relat√≥rio" na tabela de clientes
   - [x] Build passou: 152 p√°ginas

‚úÖ ETAPA 12.3 - Exporta√ß√£o em Massa V1 (CONCLU√çDO 01/12/2025 08:00)
   - [x] Bot√£o "CSV" na p√°gina de relat√≥rio do cliente
   - [x] Exporta dados autorizados (share_*) em formato CSV
   - [x] Inclui aviso √©tico no arquivo exportado
   - [x] Nome do arquivo: radar-cliente-[nome]-[data].csv
   - [x] Build passou: 154 p√°ginas

‚úÖ ETAPA 13 - Infra White-label V1 (CONCLU√çDO 01/12/2025 08:00)
   - [x] Migration: 20241201_create_professional_brand.sql
   - [x] Tabela professional_brand com RLS
   - [x] API: /api/professional/brand (GET, POST)
   - [x] P√°gina: /dashboard-profissional/marca
   - [x] Campos: display_name, brand_color, logo_url, tagline
   - [x] Cores predefinidas + color picker
   - [x] Preview em tempo real
   - [x] Toggle "Powered by Radar Narcisista"
   - [x] Link no dashboard profissional
   - [x] Build passou: 154 p√°ginas
   
   ‚ö†Ô∏è PENDENTE: Rodar migration no Supabase:
     - 20241201_create_professional_brand.sql

üîú ETAPA 13.1 - White-label V2 (BACKLOG)
   - [ ] Upload de logo direto (Supabase Storage)
   - [ ] Dom√≠nio/URL personalizada
   - [ ] Aplicar marca no convite e relat√≥rio
   - [ ] Temas completos (cores secund√°rias, fontes)

üîú ETAPA 12.4 - Exporta√ß√£o V2 (BACKLOG)
   - [ ] PDF autom√°tico gerado pelo servidor
   - [ ] Exporta√ß√£o em lote de m√∫ltiplos clientes
   - [ ] Agendamento de relat√≥rios

üîú ETAPA 12.5 - Melhorias Profissional (BACKLOG)
   - [ ] Expira√ß√£o autom√°tica de convites (7-14 dias)
   - [ ] Notifica√ß√£o por email ao criar convite
   - [ ] Hist√≥rico de atividade do profissional no cliente

================================================================================
BLOCO 14-20 (PR√ìXIMAS ETAPAS)
================================================================================

‚úÖ ETAPA 14 ‚Äì LOJA SIMPLIFICADA (CONCLU√çDO 01/12/2025)
   - [x] Definir add-ons reais: Relat√≥rio Completo (R$19,90), Kit Seguran√ßa (R$14,90)
   - [x] Conectar /loja com Stripe via /api/stripe/addon-checkout
   - [x] Integrar com lib/addons-config.ts (stripePriceId, popular)
   - [x] Criar p√°gina /loja/sucesso com Suspense
   - [x] Atualizar AddonsStore com checkout real
   - [x] Atualizar ATLAS e ROADMAP
   - Arquivos criados: app/api/stripe/addon-checkout/route.ts, app/loja/sucesso/page.tsx
   - Arquivos modificados: components/AddonsStore.tsx, lib/addons-config.ts
   - Risco: M√©dio (integra√ß√£o Stripe) ‚Üí MITIGADO

‚úÖ ETAPA 15 ‚Äì BETA COM 5 USU√ÅRIAS (CONCLU√çDO 01/12/2025)
   - [x] Verificar /admin/beta-testers (j√° existia com guia completo)
   - [x] Criar migration 20241201_beta_testers.sql
     * Campos is_beta_tester, beta_joined_at, beta_group em user_profiles
     * Tabela beta_feedback para coleta de feedback
     * Tabela beta_events para observabilidade
   - [x] APIs /api/beta/feedback e /api/beta/events
   - [x] Componente BetaFeedbackWidget (bot√£o flutuante)
   - [x] Hook useBetaTracking para tracking
   - Arquivos criados: migration, 2 APIs, 1 componente, 1 hook
   - Risco: Baixo ‚Üí MITIGADO

‚úÖ ETAPA 16 ‚Äì OR√ÅCULO V1 (CONCLU√çDO 01/12/2025)
   - [x] Analisar p√°ginas existentes: /admin/analytics, /admin/metricas, /admin/insights
   - [x] Criar p√°gina /admin/oraculo consolidada
   - [x] Definir 7 perguntas-chave que o Or√°culo responde
   - [x] Implementar agrega√ß√µes de dados reais do Supabase
   - [x] Registrar no admin-features-registry.ts
   - Arquivos criados: app/admin/oraculo/page.tsx
   - Arquivos modificados: app/admin/admin-features-registry.ts
   - Risco: M√©dio ‚Üí MITIGADO

‚úÖ ETAPA 17 ‚Äì LIMPEZA/UNIFICA√á√ÉO DE DASHBOARDS (CONCLU√çDO 01/12/2025)
   - [x] Mapear dashboards existentes (4 encontrados)
   - [x] Definir dashboard principal por persona:
     * Usu√°ria: /dashboard (Trilha do Her√≥i)
     * Profissional: /dashboard-profissional
   - [x] Legados j√° redirecionam: /dashboard-v2, /dashboard-premium
   - [x] Atualizar links internos em 9 arquivos
   - [x] Admin redireciona para /admin ap√≥s login
   - Arquivos modificados: app/app, app/login, app/biblioteca, app/espelho, app/sala,
     app/chat-premium, app/seguranca-premium, app/documentos-premium, app/configuracoes-premium
   - Risco: M√©dio ‚Üí MITIGADO

‚úÖ ETAPA 18 ‚Äì LIMPEZA ADMIN & MAPA DO SISTEMA (CONCLU√çDO 01/12/2025)
   - [x] Reorganizar ordem do menu admin
     * Or√°culo agora √© o PRIMEIRO item (defaultOrder: 0)
     * Curadoria Central logo ap√≥s (defaultOrder: 2)
     * Termos Aceitos movido para o final (defaultOrder: 50)
   - [x] Adicionar √≠cones faltantes ao AdminSidebar
   - [x] Remover entrada duplicada no registry
   - Arquivos modificados: app/admin/admin-features-registry.ts, components/AdminSidebar.tsx
   - Risco: Baixo ‚Üí MITIGADO

‚úÖ ETAPA 19 ‚Äì MANUAIS (CONCLU√çDO 01/12/2025)
   - [x] docs/MANUAL-USUARIA.md - Guia completo para usu√°rias
   - [x] docs/MANUAL-PROFISSIONAL.md - Guia para psic√≥logos/advogados
   - [x] docs/MANUAL-ADMIN.md - Guia para administradores
   - [x] docs/MANUAL-DEV.md - Guia para desenvolvedores
   - [x] docs/MANUAL-WHITELABEL.md - Guia para parceiros white-label
   - Arquivos criados: 5 manuais em docs/
   - Risco: Baixo ‚Üí MITIGADO

‚úÖ ETAPA 20 ‚Äì L√ÇMPADA GERAL (CONCLU√çDO 01/12/2025)
   - [x] LAMPADA-RADAR.txt criado na raiz
   - [x] 6 se√ß√µes estruturadas:
     * üêõ Bugs conhecidos (3 itens)
     * ü§î Confus√µes esclarecidas (3 itens)
     * ‚öñÔ∏è Decis√µes tomadas (5 itens)
     * üí° Ideias para o futuro (6 itens)
     * ‚ö†Ô∏è D√≠vidas t√©cnicas (5 itens)
     * üìù Notas importantes (4 itens)
   - [x] M√©tricas de sa√∫de do projeto
   - Arquivos criados: LAMPADA-RADAR.txt
   - Risco: Baixo ‚Üí MITIGADO

üéâ BLOCO 14-20 CONCLU√çDO! MVP 1.0 PRONTO PARA LAN√áAMENTO!

================================================================================
BLOCO 21-25 ‚Äì P√ìS-MVP 1.0 (CONSOLIDA√á√ÉO)
================================================================================

‚úÖ ETAPA 21 ‚Äì BILLING S√ìLIDO & ADD-ONS (CONCLU√çDO 01/12/2025)
   - [x] Tabela user_addons criada no Supabase
     * Campos: id, user_id, addon_key, stripe_price_id, status, credits_*, expires_at
     * RLS: usu√°rio s√≥ v√™ seus pr√≥prios add-ons
     * Fun√ß√µes: has_active_addon, get_addon_credits, consume_addon_credit
   - [x] Webhook Stripe atualizado para processar add-ons
     * Detecta mode: 'payment' vs 'subscription'
     * Registra compra em user_addons automaticamente
   - [x] APIs criadas:
     * GET /api/addons - lista add-ons do usu√°rio
     * POST /api/addons/consume - consome cr√©ditos
   - [x] lib/user-addons.ts com fun√ß√µes helper
   - [x] docs/ENV-VARIABLES.md com mapeamento de vari√°veis
   - Arquivos criados: database/migrate-user-addons.sql, lib/user-addons.ts, app/api/addons/*
   - Build passou: 161 p√°ginas

‚úÖ ETAPA 22 ‚Äì OR√ÅCULO V2 INTEGRADO (CONCLU√çDO 01/12/2025)
   - [x] Rota POST /api/oraculo-v2 criada
     * Recebe: question, user_role, manual_context, url_atual, plan
     * Retorna: JSON com modo, risco, titulo, resposta, passos, links
     * Autentica√ß√£o: apenas admin (BLOCO 21-25)
   - [x] Tabela oraculo_logs criada
     * Campos: user_id, user_role, question, resposta_json, flag_risco_alto
     * Views: oraculo_usage_daily, oraculo_top_questions
     * Fun√ß√£o: log_oraculo_call()
   - [x] Bot√£o "Perguntar ao Or√°culo" implementado
     * Componente: components/OraculoButton.tsx
     * Integrado em: /admin, /admin/oraculo
     * UI: modal com sugest√µes, resposta estruturada
   - [x] Manuais atualizados
     * MANUAL-ADMIN.md: se√ß√£o Or√°culo V2 completa
     * MANUAL-DEV.md: documenta√ß√£o do endpoint
   - [x] docs/ORACULO-V2-PROMPT.md com system prompt
   - Arquivos criados: app/api/oraculo-v2/route.ts, components/OraculoButton.tsx, database/migrate-oraculo-logs.sql
   - Build passou: 162 p√°ginas

‚úÖ ETAPA 23 ‚Äì SEGURAN√áA T√âCNICA & OBSERVABILIDADE (CONCLU√çDO 01/12/2025)
   - [x] Rate limiting implementado
     * lib/rate-limit.ts com armazenamento em mem√≥ria
     * Configura√ß√µes pr√©-definidas: AI (10/min), AUTH (5/min), API (100/min)
     * Aplicado em /api/oraculo-v2
   - [x] Logger estruturado
     * lib/logger.ts com formato JSON
     * N√≠veis: debug, info, warn, error
     * M√©todos: request, response, apiError, userAction, security
   - [x] Endpoint /api/health
     * Verifica: database, stripe, openai
     * Status: healthy, degraded, unhealthy
     * Retorna: version, uptime, timestamp
   - Arquivos criados: lib/rate-limit.ts, lib/logger.ts, app/api/health/route.ts
   - Build passou: 163 p√°ginas

‚úÖ ETAPA 24 ‚Äì MANUAIS & LINKS INTERNOS (CONCLU√çDO 01/12/2025)
   - [x] Todos os 5 manuais atualizados
     * MANUAL-ADMIN.md: se√ß√£o Seguran√ßa & Observabilidade, links √∫teis
     * MANUAL-USUARIA.md: tabela de links r√°pidos, FAQ expandido
     * MANUAL-PROFISSIONAL.md: links para documenta√ß√£o relacionada
     * MANUAL-DEV.md: tabela de APIs principais, arquivos de projeto
     * MANUAL-WHITELABEL.md: links para outros manuais
   - [x] Links internos inseridos em todos os manuais
   - Build passou: 163 p√°ginas

‚úÖ ETAPA 25 ‚Äì QA T√âCNICO + CHECKLIST P√ìS-MVP (CONCLU√çDO 01/12/2025)
   - [x] CHECKLIST-POS-MVP.md criado
     * Lista de migrations pendentes
     * Configura√ß√µes pendentes (Stripe, Vercel)
     * Testes manuais a realizar
     * D√≠vidas t√©cnicas mapeadas
     * Pr√≥ximos passos (BLOCO 26-30)
   - [x] L√ÇMPADA-RADAR.txt atualizado
   - [x] Documenta√ß√£o final consolidada
   - Build passou: 163 p√°ginas

üéâ BLOCO 21-25 CONCLU√çDO! MVP 1.0.25 PRONTO!

================================================================================
PATCH OR√ÅCULO ‚Äì BLOCO 21-25 (VER docs/PATCH-ORACULO.md)
================================================================================

- OR√ÅCULO V1 = painel /admin/oraculo ‚Üí s√≥ ADMIN (j√° existe)
- OR√ÅCULO V2 = IA de suporte ‚Üí NESTE BLOCO √© apenas para ADMIN
- Abertura para outros perfis (usu√°ria/profissional/dev/whitelabel) = BLOCO 26-30
- Qualquer texto antigo que diga o contr√°rio: IGNORAR, este PATCH tem prioridade

================================================================================
BLOCO 26-30 ‚Äì OR√ÅCULO V2 MULTIPERFIL + INFRA COMUNICA√á√ÉO IA (EM ANDAMENTO)
================================================================================

‚úÖ BLOCO 21-25 CONCLU√çDO! Iniciando BLOCO 26-30.

‚úÖ ETAPA 26 ‚Äì TEMPLATE DE RESUMO + CHECKLIST + REGRAS (CONCLU√çDO 01/12/2025)
   - [x] docs/FORMATO-RESUMO-ETAPAS.md atualizado (v2.0)
   - [x] docs/CHECKLIST-RESUMO-IA.md criado
   - [x] docs/PATCHES-ORACULO-COMPLETO.md criado
   - [x] scripts/validar-resumo-ia.ts criado
   - [x] Documenta√ß√£o principal atualizada
   - [x] Commit: 6b93a37

‚úÖ ETAPA 27 ‚Äì ORACULO_V2_CORE (CONCLU√çDO 01/12/2025)
   - [x] lib/oraculo-core.ts criado (n√∫cleo reutiliz√°vel)
   - [x] Prompts por perfil: admin, usuaria, profissional, dev, whitelabel
   - [x] Fun√ß√µes: callOraculo, buildSystemPrompt, buildUserContext, parseOraculoResponse
   - [x] /api/oraculo-v2 refatorado para usar o core
   - [x] docs/ORACULO-CORE.md criado
   - Build passou: 163 p√°ginas

‚úÖ ETAPA 28 ‚Äì INFRA MULTIPERFIL (CONCLU√çDO 01/12/2025)
   - [x] database/migrate-oraculo-settings.sql criado
     * Tabela oraculo_plan_settings (status, limites di√°rio/semanal/mensal)
     * Tabela oraculo_usage (controle de consumo)
     * Fun√ß√µes: can_use_oraculo, register_oraculo_usage
     * Dados iniciais: admin sempre habilitado, outros desabilitados
   - [x] lib/oraculo-settings.ts criado
     * canUseOraculo, registerOraculoUsage, getOraculoSettings
     * listAllOraculoSettings, getOraculoUsage
   - [x] /api/oraculo-v2 integrado com verifica√ß√£o de limites
   - Build passou: 163 p√°ginas

‚úÖ ETAPA 29 ‚Äì EXPOR OR√ÅCULO V2 PARA OUTROS PERFIS (CONCLU√çDO 01/12/2025)
   - [x] components/OraculoMultiperfil.tsx criado
     * Suporta todos os perfis: admin, usuaria, profissional, dev, whitelabel
     * Cores e sugest√µes customizadas por perfil
     * Mostra info de uso/limite quando aplic√°vel
   - [x] components/OraculoHint.tsx criado
     * Variantes: inline, banner, card
     * Permite perguntar diretamente ao Or√°culo
   - Build passou: 163 p√°ginas

üîú ETAPA 30 ‚Äì INTEGRA√á√ÉO GERADOR DE SAAS + QA
   - [ ] Criar docs/ORACULO-CORE-SAAS.md
   - [ ] Testes m√≠nimos para ORACULO_V2_CORE
   - [ ] QA do Or√°culo multiperfil
   - [ ] Atualizar TESTES-RADAR.txt

================================================================================
BLOCO 31-35 ‚Äì FRONT PAGE + MATRIZ MULTI-INST√ÇNCIA (FUTURO)
================================================================================

üîú ETAPA 31 ‚Äì REFORMA INTELIGENTE DA FRONT PAGE
   - [ ] Redesenhar front page √∫nica e segmentada
   - [ ] Se√ß√µes por perfil (usu√°ria, profissional, ONG, whitelabel)
   - [ ] Narrativa atualizada (Radar + Or√°culo + Gerador)

üîú ETAPA 32 ‚Äì MATRIZ OR√ÅCULO MULTI-INST√ÇNCIA
   - [ ] Implementar matriz V1/V2 por perfil
   - [ ] Inst√¢ncias separadas para whitelabel
   - [ ] Op√ß√µes no Gerador de SaaS

================================================================================
IDEIAS FUTURAS (N√ÉO IMPLEMENTAR AGORA)
================================================================================

- Vers√£o com voz (transcri√ß√£o de √°udio)
- Vers√£o com imagens (upload de prints)
- App mobile (React Native ou PWA)
- Radar Profissional B2B completo
- Comunidade/f√≥rum entre usu√°rias
- Gamifica√ß√£o avan√ßada
- Integra√ß√µes com calend√°rio

FERRAMENTAS PARA INTEGRAR (GUARDADAS NA MEM√ìRIA):
- Tremor (dashboards bonitos)
- Arcjet (seguran√ßa, rate limiting)
- Crisp/Tawk.to (chatbot frontpage)
- Typebot + Z-API (WhatsApp bot)
- Crisp (helpdesk/suporte)

================================================================================
HIST√ìRICO DE CONCLUS√ïES
================================================================================

[29/11/2025] Sistema de Planos Administr√°veis
- Criadas tabelas billing_plans e billing_plan_promotions
- Criada tela /admin/planos com CRUD completo
- Integra√ß√£o homepage e /planos com hook usePlans
- Suporte a promo√ß√µes com labels e pre√ßos riscados
- Fallback autom√°tico para plans-config.ts

[29/11/2025 21:00] Corre√ß√µes P√≥s-Deploy
- Corrigido acesso admin (getUser em vez de getSession)
- Adicionada migration RLS para admins em billing_plans
- Sistema de Planos 100% funcional em produ√ß√£o

[29/11/2025 21:15] Sistema de Mem√≥ria do Projeto
- Criado ROADMAP-RADAR.txt
- Criado TESTES-RADAR.txt
- Criado script gerar-espelho-codigo.cjs
- Comando: npm run espelho-codigo

[29/11/2025 21:25] Corre√ß√£o Bot√£o Config Menu
- Problema: Bot√£o "Config Menu" no admin usava localhost hardcoded
- Solu√ß√£o: Trocado para caminho relativo /admin/menu-config
- Arquivo: app/admin/AdminClient.tsx

[29/11/2025 22:10] Unifica√ß√£o do Di√°rio
- Arquivadas rotas duplicadas: /diario-premium, /timeline-premium, /linha-tempo
- Movidas para app/_archive/
- Rotas oficiais: /diario, /diario/novo, /diario/[id], /diario/[id]/editar, /diario/timeline
- Atualizados todos os links no dashboard e homepage
- Build passou: 129 p√°ginas (antes 132)

[29/11/2025 22:35] ETAPA 2 - Tri√¢ngulo Clareza ‚áÑ Di√°rio ‚áÑ Chat (COMPLETA)
- Clareza ‚Üí Di√°rio: Ao salvar teste como base, cria entrada autom√°tica (clarity_baseline)
- Di√°rio ‚Üí Chat: Chat recebe contexto dos √∫ltimos 3 epis√≥dios mais intensos
- Clareza ‚Üí Chat: Chat j√° recebia perfil de clareza (confirmado funcionando)
- Di√°rio/Novo: Aceita ?from=clarity_result&clarity_test_id=UUID para pr√©-preencher
- Tipos atualizados: JournalEntryType com 6 tipos (normal, clarity_baseline, chat_summary, etc.)
- Arquivos modificados:
  - app/api/clarity/activate-profile/route.ts
  - app/api/chat/route.ts
  - lib/diary-types.ts
  - app/diario/novo/page.tsx (pr√©-preenchimento via query string)

[29/11/2025 23:15] ETAPA 3 - Di√°rio + Timeline + Dashboard Conectados ao Tri√¢ngulo (COMPLETA)
- Di√°rio com badge "Perfil de Clareza" para entradas clarity_baseline
- Timeline com badge "Perfil de Clareza" + destaque "Intenso" para mood_intensity >= 7
- Dashboard j√° consumia dados reais (confirmado: clarity_tests, journal_entries, ai_messages)
- Tipo JournalEntry em types/database.ts atualizado com entry_type e clarity_test_id
- Rotas antigas j√° estavam em app/_archive/ (diario-premium, timeline-premium, linha-tempo)
- Arquivos modificados:
  - types/database.ts (JournalEntryType adicionado)
  - app/diario/page.tsx (badge clarity_baseline)
  - app/diario/timeline/page.tsx (badge clarity_baseline + mood_intensity)
  - ATLAS-RADAR-NARCISISTA.txt (se√ß√£o Dashboard atualizada)

[30/11/2025 01:00] ETAPA 4 - Chat ‚Üí Di√°rio (COMPLETA)
- API /api/chat/save-summary criada
- Bot√£o "Salvar no Di√°rio" no chat ap√≥s 2+ mensagens
- Modal de resumo com texto, intensidade e tags
- Integra√ß√£o com modal de encerramento
- Badge "Resumo do Chat" no Di√°rio e Timeline
- Arquivos modificados:
  - app/api/chat/save-summary/route.ts (novo)
  - app/chat/page.tsx (modal e bot√£o)
  - app/diario/page.tsx (badge)
  - app/diario/timeline/page.tsx (badge)

[30/11/2025 01:30] ETAPA 5 - Editor Visual da Frontpage (COMPLETA)
- Migration 007_frontpage_config.sql criada
- API /api/admin/frontpage-editor criada (CRUD)
- Editor por formul√°rios: /admin/frontpage-editor
- Editor visual com preview: /admin/frontpage-visual
- Hook useFrontpageConfig.ts criado
- Preview responsivo (desktop/tablet/mobile)
- PENDENTE: Rodar migration no Supabase
- Arquivos criados:
  - database/migrations/007_frontpage_config.sql
  - app/api/admin/frontpage-editor/route.ts
  - app/admin/frontpage-editor/page.tsx
  - app/admin/frontpage-visual/page.tsx
  - hooks/useFrontpageConfig.ts

[30/11/2025 11:30] ETAPA 6 - Tri√¢ngulo V2 (COMPLETA)
- Filtros por entry_type no /diario (clarity_baseline, chat_summary, normal)
- Filtros por entry_type no /diario/timeline
- Legenda do Tri√¢ngulo na Timeline (‚ú® Perfil, üí¨ Chat, üî• Intenso)
- Card "Estado do Tri√¢ngulo" no /dashboard com 3 colunas
- Status din√¢mico: "Tri√¢ngulo Ativo" ou "Incompleto"
- Mensagem explicativa do que falta completar
- PENDENTE-V2: Auto-resumo IA no Chat
- Arquivos modificados:
  - app/diario/page.tsx (filtros por entry_type)
  - app/diario/timeline/page.tsx (filtros + legenda)
  - app/dashboard/page.tsx (card Estado do Tri√¢ngulo)

[30/11/2025 15:20] ETAPA 7.3 - Plano de Seguran√ßa no Tri√¢ngulo (COMPLETA)
- API REST /api/safety-plan criada (GET, POST, PATCH)
- Card "Plano de Seguran√ßa" no Dashboard com status colorido
- Banner de alerta de risco f√≠sico no Dashboard
- Detec√ß√£o de risco f√≠sico no Chat via regex (PHYSICAL_RISK_REGEX)
- Banner de alerta no Chat quando risco f√≠sico detectado
- Cria√ß√£o autom√°tica de risk_alert via Chat
- Badge üõ°Ô∏è "Plano de Seguran√ßa" no Di√°rio e Timeline
- Tipo 'safety_plan' adicionado ao JournalEntryType
- risk_alert autom√°tico quando hasPhysicalRisk no Teste de Clareza
- Build passou: 134 p√°ginas
- Arquivos criados:
  - app/api/safety-plan/route.ts
- Arquivos modificados:
  - types/database.ts
  - app/api/clarity/activate-profile/route.ts
  - app/api/chat/route.ts
  - app/dashboard/page.tsx
  - app/chat/page.tsx
  - app/diario/page.tsx
  - app/diario/timeline/page.tsx

================================================================================
BUGS CONHECIDOS (A CORRIGIR)
================================================================================

Nenhum bug cr√≠tico identificado no momento.

MIGRATIONS PENDENTES:
- 007_frontpage_config.sql ‚Üí Rodar no Supabase Dashboard

================================================================================
FIM DO ROADMAP
================================================================================
