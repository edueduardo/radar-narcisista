================================================================================
RADAR NARCISISTA – ROADMAP
================================================================================
Versão: 1.4
Última atualização: 30/11/2025 09:20 (UTC-5)

================================================================================
STATUS GERAL
================================================================================

Versão atual do produto: MVP 0.9
Objetivo desta fase: Fechar MVP vendável B2C

================================================================================
PRIORIDADE AGORA (NÃO MEXER NA ORDEM SEM AUTORIZAÇÃO)
================================================================================

1) ✅ Sistema de Planos Administráveis (CONCLUÍDO 29/11/2025)
   - Tabelas billing_plans e billing_plan_promotions
   - Tela /admin/planos
   - Integração homepage e /planos
   - Promoções com labels e datas

2) ✅ Fechar Diário (CONCLUÍDO 29/11/2025)
   - Rotas unificadas: /diario, /diario/novo, /diario/timeline
   - Conectado com Teste de Clareza (entry_type, clarity_test_id)
   - Timeline funcional com badges
   - Badges "Perfil de Clareza" e "Intenso"

3) ✅ Fechar Chat (CONCLUÍDO 30/11/2025)
   - Coach IA usando contexto do teste ✅
   - Coach IA usando últimos diários ✅
   - Limites por plano funcionando ✅
   - Chat → Diário (salvar resumo) ✅

4) ✅ Editor Visual da Frontpage (CONCLUÍDO 30/11/2025)
   - Promoções dinâmicas funcionando ✅
   - Planos lendo do banco ✅
   - Editor por formulários (/admin/frontpage-editor) ✅
   - Editor visual com preview (/admin/frontpage-visual) ✅
   - Hook useFrontpageConfig.ts criado ✅
   - Migration 007_frontpage_config.sql criada ✅
   - PENDENTE: Rodar migration no Supabase

================================================================================
DEPOIS DISSO
================================================================================

5) Loja simplificada (2–3 add-ons reais)
6) Começar teste com 5 usuárias beta
7) Integração completa Stripe com novos planos
8) Painel admin de usuários

================================================================================
IDEIAS FUTURAS (NÃO IMPLEMENTAR AGORA)
================================================================================

- Versão com voz (transcrição de áudio)
- Versão com imagens (upload de prints)
- App mobile (React Native ou PWA)
- Radar Profissional B2B completo
- Comunidade/fórum entre usuárias
- Gamificação avançada
- Integrações com calendário

FERRAMENTAS PARA INTEGRAR (GUARDADAS NA MEMÓRIA):
- Tremor (dashboards bonitos)
- Arcjet (segurança, rate limiting)
- Crisp/Tawk.to (chatbot frontpage)
- Typebot + Z-API (WhatsApp bot)
- Crisp (helpdesk/suporte)

================================================================================
HISTÓRICO DE CONCLUSÕES
================================================================================

[29/11/2025] Sistema de Planos Administráveis
- Criadas tabelas billing_plans e billing_plan_promotions
- Criada tela /admin/planos com CRUD completo
- Integração homepage e /planos com hook usePlans
- Suporte a promoções com labels e preços riscados
- Fallback automático para plans-config.ts

[29/11/2025 21:00] Correções Pós-Deploy
- Corrigido acesso admin (getUser em vez de getSession)
- Adicionada migration RLS para admins em billing_plans
- Sistema de Planos 100% funcional em produção

[29/11/2025 21:15] Sistema de Memória do Projeto
- Criado ROADMAP-RADAR.txt
- Criado TESTES-RADAR.txt
- Criado script gerar-espelho-codigo.cjs
- Comando: npm run espelho-codigo

[29/11/2025 21:25] Correção Botão Config Menu
- Problema: Botão "Config Menu" no admin usava localhost hardcoded
- Solução: Trocado para caminho relativo /admin/menu-config
- Arquivo: app/admin/AdminClient.tsx

[29/11/2025 22:10] Unificação do Diário
- Arquivadas rotas duplicadas: /diario-premium, /timeline-premium, /linha-tempo
- Movidas para app/_archive/
- Rotas oficiais: /diario, /diario/novo, /diario/[id], /diario/[id]/editar, /diario/timeline
- Atualizados todos os links no dashboard e homepage
- Build passou: 129 páginas (antes 132)

[29/11/2025 22:35] ETAPA 2 - Triângulo Clareza ⇄ Diário ⇄ Chat (COMPLETA)
- Clareza → Diário: Ao salvar teste como base, cria entrada automática (clarity_baseline)
- Diário → Chat: Chat recebe contexto dos últimos 3 episódios mais intensos
- Clareza → Chat: Chat já recebia perfil de clareza (confirmado funcionando)
- Diário/Novo: Aceita ?from=clarity_result&clarity_test_id=UUID para pré-preencher
- Tipos atualizados: JournalEntryType com 6 tipos (normal, clarity_baseline, chat_summary, etc.)
- Arquivos modificados:
  - app/api/clarity/activate-profile/route.ts
  - app/api/chat/route.ts
  - lib/diary-types.ts
  - app/diario/novo/page.tsx (pré-preenchimento via query string)

[29/11/2025 23:15] ETAPA 3 - Diário + Timeline + Dashboard Conectados ao Triângulo (COMPLETA)
- Diário com badge "Perfil de Clareza" para entradas clarity_baseline
- Timeline com badge "Perfil de Clareza" + destaque "Intenso" para mood_intensity >= 7
- Dashboard já consumia dados reais (confirmado: clarity_tests, journal_entries, ai_messages)
- Tipo JournalEntry em types/database.ts atualizado com entry_type e clarity_test_id
- Rotas antigas já estavam em app/_archive/ (diario-premium, timeline-premium, linha-tempo)
- Arquivos modificados:
  - types/database.ts (JournalEntryType adicionado)
  - app/diario/page.tsx (badge clarity_baseline)
  - app/diario/timeline/page.tsx (badge clarity_baseline + mood_intensity)
  - ATLAS-RADAR-NARCISISTA.txt (seção Dashboard atualizada)

[30/11/2025 01:00] ETAPA 4 - Chat → Diário (COMPLETA)
- API /api/chat/save-summary criada
- Botão "Salvar no Diário" no chat após 2+ mensagens
- Modal de resumo com texto, intensidade e tags
- Integração com modal de encerramento
- Badge "Resumo do Chat" no Diário e Timeline
- Arquivos modificados:
  - app/api/chat/save-summary/route.ts (novo)
  - app/chat/page.tsx (modal e botão)
  - app/diario/page.tsx (badge)
  - app/diario/timeline/page.tsx (badge)

[30/11/2025 01:30] ETAPA 5 - Editor Visual da Frontpage (COMPLETA)
- Migration 007_frontpage_config.sql criada
- API /api/admin/frontpage-editor criada (CRUD)
- Editor por formulários: /admin/frontpage-editor
- Editor visual com preview: /admin/frontpage-visual
- Hook useFrontpageConfig.ts criado
- Preview responsivo (desktop/tablet/mobile)
- PENDENTE: Rodar migration no Supabase
- Arquivos criados:
  - database/migrations/007_frontpage_config.sql
  - app/api/admin/frontpage-editor/route.ts
  - app/admin/frontpage-editor/page.tsx
  - app/admin/frontpage-visual/page.tsx
  - hooks/useFrontpageConfig.ts

================================================================================
BUGS CONHECIDOS (A CORRIGIR)
================================================================================

Nenhum bug crítico identificado no momento.

MIGRATIONS PENDENTES:
- 007_frontpage_config.sql → Rodar no Supabase Dashboard

================================================================================
FIM DO ROADMAP
================================================================================
