================================================================================
ðŸ’¡ LÃ‚MPADA RADAR - OBSERVAÃ‡Ã•ES E PENDÃŠNCIAS
================================================================================
VersÃ£o: 1.1
Ãšltima atualizaÃ§Ã£o: 01/12/2025 15:00 (UTC-5)
ResponsÃ¡vel: Equipe Radar Narcisista

================================================================================
ðŸ“‹ O QUE Ã‰ ESTE ARQUIVO?
================================================================================

A "LÃ¢mpada" Ã© um documento vivo que consolida:
- ðŸ› BUGS conhecidos que ainda nÃ£o foram corrigidos
- ðŸ¤” CONFUSÃ•ES que precisam ser esclarecidas
- âš–ï¸ DECISÃ•ES tÃ©cnicas ou de produto tomadas
- ðŸ’¡ IDEIAS para o futuro (nÃ£o implementar agora)
- âš ï¸ DÃVIDAS TÃ‰CNICAS acumuladas
- ðŸ“ NOTAS importantes para nÃ£o esquecer

REGRA: Antes de implementar algo novo, consulte este arquivo!

================================================================================
ðŸ› BUGS CONHECIDOS
================================================================================

[B001] Webhook Stripe para add-ons
----------------------------------------------------------------------
Status: âœ… RESOLVIDO (ETAPA 21)
Prioridade: ALTA
DescriÃ§Ã£o: O webhook de pagamento de add-ons nÃ£o estava criando registros
           na tabela user_addons apÃ³s pagamento bem-sucedido.
SoluÃ§Ã£o: Webhook atualizado em lib/stripe.ts para detectar mode: 'payment'
         e chamar processAddonPurchase() que insere em user_addons.
Arquivos: lib/stripe.ts
Resolvido em: 01/12/2025

[B002] Tabela user_addons nÃ£o existe
----------------------------------------------------------------------
Status: âœ… RESOLVIDO (ETAPA 21)
Prioridade: ALTA
DescriÃ§Ã£o: A tabela user_addons precisava ser criada no Supabase para
           armazenar add-ons comprados pelos usuÃ¡rios.
SoluÃ§Ã£o: Migration criada em database/migrate-user-addons.sql com:
         - Tabela user_addons com campos completos
         - RLS para seguranÃ§a
         - FunÃ§Ãµes has_active_addon, get_addon_credits, consume_addon_credit
Arquivos: database/migrate-user-addons.sql
Resolvido em: 01/12/2025

[B004] Migration user_addons pendente de execuÃ§Ã£o
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
Prioridade: ALTA
DescriÃ§Ã£o: A migration database/migrate-user-addons.sql foi criada mas
           ainda nÃ£o foi executada no Supabase de produÃ§Ã£o.
Impacto: Webhook vai falhar ao tentar inserir em user_addons.
Workaround: Executar migration manualmente no Supabase SQL Editor.
Arquivos: database/migrate-user-addons.sql
Criado em: 01/12/2025

[B003] Cache de menu admin no localStorage
----------------------------------------------------------------------
Status: ðŸŸ¢ BAIXA PRIORIDADE
Prioridade: BAIXA
DescriÃ§Ã£o: O menu admin salva ordem no localStorage, mas novas features
           podem nÃ£o aparecer automaticamente para admins existentes.
Impacto: Admin pode nÃ£o ver novas telas atÃ© limpar cache.
Workaround: BotÃ£o "Limpar cache de IA" no sidebar.
Arquivos: lib/admin-menu-config.ts
Criado em: 01/12/2025

================================================================================
ðŸ¤” CONFUSÃ•ES A ESCLARECER
================================================================================

[C001] DiferenÃ§a entre /dashboard e /dashboard-v2
----------------------------------------------------------------------
Status: âœ… RESOLVIDO (ETAPA 17)
DescriÃ§Ã£o: Havia confusÃ£o sobre qual dashboard era o principal.
DecisÃ£o: /dashboard Ã© o principal (Trilha do HerÃ³i).
         /dashboard-v2 e /dashboard-premium redirecionam para /dashboard.

[C002] Onde ficam as configuraÃ§Ãµes de IA?
----------------------------------------------------------------------
Status: âœ… DOCUMENTADO
DescriÃ§Ã£o: MÃºltiplas telas de configuraÃ§Ã£o de IA causavam confusÃ£o.
DecisÃ£o: 
  - /admin = Config IAs (visÃ£o geral)
  - /admin/configurar-ias = API Keys
  - /admin/gerenciar-ias = Adicionar novas IAs
  - /admin/custos-ia = Monitorar gastos
  - /admin/mapa-ias = SaÃºde das IAs

[C003] Qual Ã© a fonte da verdade do projeto?
----------------------------------------------------------------------
Status: âœ… DOCUMENTADO
DescriÃ§Ã£o: DÃºvida sobre qual arquivo consultar primeiro.
DecisÃ£o:
  1. TUDO PARA O GPT.txt - HistÃ³rico completo
  2. ATLAS-RADAR-NARCISISTA.txt - Mapa tÃ©cnico
  3. ROADMAP-RADAR.txt - Roadmap e etapas
  4. TESTES-RADAR.txt - Checklist de testes
  5. LAMPADA-RADAR.txt - Este arquivo (observaÃ§Ãµes)

================================================================================
âš–ï¸ DECISÃ•ES TOMADAS
================================================================================

[D001] Stack tecnolÃ³gica
----------------------------------------------------------------------
Data: 28/11/2025
DecisÃ£o: Next.js 16 + Supabase + Stripe + TailwindCSS 4
Motivo: Stack moderna, serverless, fÃ¡cil de escalar.
Alternativas descartadas: Firebase, Prisma, MongoDB.

[D002] Modelo de negÃ³cio
----------------------------------------------------------------------
Data: 28/11/2025
DecisÃ£o: Freemium B2C + Plano Profissional B2B
Motivo: AlcanÃ§ar vÃ­timas (gratuito) + monetizar via profissionais.
Planos: Gratuito, Essencial, AvanÃ§ado, Premium, Profissional.

[D003] OrÃ¡culo como primeiro item do menu admin
----------------------------------------------------------------------
Data: 01/12/2025
DecisÃ£o: OrÃ¡culo (defaultOrder: 0) Ã© o primeiro item do menu.
Motivo: VisÃ£o executiva deve ser o ponto de entrada do admin.
Arquivos: app/admin/admin-features-registry.ts

[D004] Termos Aceitos no final do menu
----------------------------------------------------------------------
Data: 01/12/2025
DecisÃ£o: Termos Aceitos (defaultOrder: 50) fica no final.
Motivo: Ãrea sensÃ­vel, nÃ£o deve ser acessada acidentalmente.
Arquivos: app/admin/admin-features-registry.ts

[D005] Dashboards unificados
----------------------------------------------------------------------
Data: 01/12/2025
DecisÃ£o: 
  - UsuÃ¡ria: /dashboard (Trilha do HerÃ³i)
  - Profissional: /dashboard-profissional
  - Legados redirecionam automaticamente
Motivo: Evitar confusÃ£o e manter UX consistente.

[D006] Estrutura de billing de add-ons
----------------------------------------------------------------------
Data: 01/12/2025
DecisÃ£o:
  - Tabela user_addons com addon_key correspondendo ao id em addons-config.ts
  - Webhook Stripe detecta mode: 'payment' para add-ons
  - CrÃ©ditos gerenciados por credits_total e credits_remaining
  - ExpiraÃ§Ã£o via expires_at (NULL = permanente)
Motivo: Fluxo consistente entre Stripe, banco e app.
Arquivos: database/migrate-user-addons.sql, lib/stripe.ts, lib/user-addons.ts

================================================================================
ðŸ’¡ IDEIAS PARA O FUTURO (NÃƒO IMPLEMENTAR AGORA)
================================================================================

[I001] App mobile nativo
----------------------------------------------------------------------
Prioridade: MÃ‰DIA
DescriÃ§Ã£o: Criar app React Native para iOS e Android.
BenefÃ­cio: Melhor UX, notificaÃ§Ãµes push, modo offline.
DependÃªncias: MVP estÃ¡vel, validaÃ§Ã£o de mercado.
Estimativa: 3-6 meses.

[I002] IntegraÃ§Ã£o com WhatsApp
----------------------------------------------------------------------
Prioridade: ALTA
DescriÃ§Ã£o: Permitir que usuÃ¡rias interajam via WhatsApp.
BenefÃ­cio: Canal mais acessÃ­vel, menor barreira de entrada.
DependÃªncias: API do WhatsApp Business, custos.
Estimativa: 1-2 meses.

[I003] GamificaÃ§Ã£o avanÃ§ada
----------------------------------------------------------------------
Prioridade: BAIXA
DescriÃ§Ã£o: Adicionar conquistas, nÃ­veis, recompensas.
BenefÃ­cio: Aumentar engajamento e retenÃ§Ã£o.
DependÃªncias: MÃ©tricas de uso estÃ¡veis.
Estimativa: 1 mÃªs.

[I004] Comunidade moderada
----------------------------------------------------------------------
Prioridade: MÃ‰DIA
DescriÃ§Ã£o: FÃ³rum/chat entre usuÃ¡rias com moderaÃ§Ã£o.
BenefÃ­cio: Suporte entre pares, senso de comunidade.
DependÃªncias: Sistema de moderaÃ§Ã£o, polÃ­ticas claras.
Estimativa: 2-3 meses.

[I005] IA de voz
----------------------------------------------------------------------
Prioridade: BAIXA
DescriÃ§Ã£o: Permitir interaÃ§Ã£o por voz com o Coach.
BenefÃ­cio: Acessibilidade, conveniÃªncia.
DependÃªncias: Whisper API, custos de transcriÃ§Ã£o.
Estimativa: 1 mÃªs.

[I006] RelatÃ³rio para advogados
----------------------------------------------------------------------
Prioridade: ALTA
DescriÃ§Ã£o: Gerar relatÃ³rio formatado para uso em processos.
BenefÃ­cio: Valor agregado para profissionais, diferencial.
DependÃªncias: ValidaÃ§Ã£o jurÃ­dica, templates.
Estimativa: 2 semanas.

[I007] ORÃCULO V2 MULTIPERFIL (BLOCO 26-30)
----------------------------------------------------------------------
Prioridade: MÃ‰DIA
DescriÃ§Ã£o: Expandir o uso do ORÃCULO V2 para TODOS os perfis:
           usuÃ¡ria, profissional, admin, dev, whitelabel.
BenefÃ­cio: IA de suporte unificada para todo o produto.
DependÃªncias: ETAPA 22 (OrÃ¡culo V2 para admin) concluÃ­da.
Estimativa: BLOCO 26-30.
Nota: Unificar em mÃ³dulo ORACULO_V2_CORE reutilizÃ¡vel pelo GERADOR DE SAAS.

================================================================================
âš ï¸ DÃVIDAS TÃ‰CNICAS
================================================================================

[T001] Testes automatizados
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
DescriÃ§Ã£o: NÃ£o hÃ¡ testes unitÃ¡rios ou E2E implementados.
Impacto: Risco de regressÃµes em deploys.
SoluÃ§Ã£o: Implementar Jest + Playwright.
Estimativa: 1 semana.

[T002] DocumentaÃ§Ã£o de APIs
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
DescriÃ§Ã£o: APIs nÃ£o tÃªm documentaÃ§Ã£o Swagger/OpenAPI.
Impacto: Dificulta integraÃ§Ãµes e onboarding de devs.
SoluÃ§Ã£o: Adicionar swagger-ui ou similar.
Estimativa: 2-3 dias.

[T003] Logs estruturados
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
DescriÃ§Ã£o: Logs sÃ£o console.log simples, sem estrutura.
Impacto: DifÃ­cil debugar em produÃ§Ã£o.
SoluÃ§Ã£o: Implementar Pino ou Winston.
Estimativa: 1 dia.

[T004] Monitoramento de erros
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
DescriÃ§Ã£o: NÃ£o hÃ¡ Sentry ou similar configurado.
Impacto: Erros em produÃ§Ã£o podem passar despercebidos.
SoluÃ§Ã£o: Configurar Sentry.
Estimativa: 2 horas.

[T005] Rate limiting
----------------------------------------------------------------------
Status: ðŸŸ¡ PENDENTE
DescriÃ§Ã£o: APIs nÃ£o tÃªm rate limiting implementado.
Impacto: VulnerÃ¡vel a abuso e DDoS.
SoluÃ§Ã£o: Implementar rate limiting no middleware.
Estimativa: 1 dia.

================================================================================
ðŸ“ NOTAS IMPORTANTES
================================================================================

[N001] Credenciais de produÃ§Ã£o
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Todas as credenciais de produÃ§Ã£o estÃ£o no Vercel.
      NUNCA commitar .env.local com chaves reais.
      Stripe estÃ¡ em modo TESTE atÃ© lanÃ§amento.

[N002] Backup do banco
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Supabase faz backup automÃ¡tico diÃ¡rio.
      Para restore, acessar Supabase Dashboard > Backups.

[N003] Deploy automÃ¡tico
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Push para main = deploy automÃ¡tico no Vercel.
      Verificar build antes de fazer push.
      URL: https://vercel.com/radar-narcisista-brs-projects

[N004] Contatos de emergÃªncia
----------------------------------------------------------------------
Data: 01/12/2025
Nota: 
  - Eduardo (dev): [email]
  - Suporte Vercel: vercel.com/support
  - Suporte Supabase: supabase.com/support
  - Suporte Stripe: stripe.com/support

================================================================================
ðŸ“Š MÃ‰TRICAS DE SAÃšDE DO PROJETO
================================================================================

Ãšltima verificaÃ§Ã£o: 01/12/2025 15:00

| MÃ©trica                  | Valor    | Status |
|--------------------------|----------|--------|
| Etapas concluÃ­das        | 21/25    | âœ…     |
| Build passando           | Sim      | âœ…     |
| PÃ¡ginas geradas          | 161      | âœ…     |
| Bugs crÃ­ticos            | 1        | ðŸŸ¡     |
| DÃ­vidas tÃ©cnicas         | 5        | ðŸŸ¡     |
| DocumentaÃ§Ã£o atualizada  | Sim      | âœ…     |
| Ãšltimo deploy            | Hoje     | âœ…     |

================================================================================
ðŸ”„ HISTÃ“RICO DE ATUALIZAÃ‡Ã•ES DESTE ARQUIVO
================================================================================

01/12/2025 15:00 - ETAPA 21 (Billing SÃ³lido & Add-ons)
  - B001 e B002 resolvidos (webhook e tabela user_addons)
  - B004 adicionado (migration pendente de execuÃ§Ã£o)
  - D006 adicionada (estrutura de billing de add-ons)
  - I007 adicionada (OrÃ¡culo V2 Multiperfil para BLOCO 26-30)
  - MÃ©tricas atualizadas: 21/25 etapas, 161 pÃ¡ginas

01/12/2025 13:30 - CriaÃ§Ã£o inicial (ETAPA 20)
  - Estrutura base com 6 seÃ§Ãµes
  - 3 bugs conhecidos documentados
  - 3 confusÃµes esclarecidas
  - 5 decisÃµes registradas
  - 6 ideias para o futuro
  - 5 dÃ­vidas tÃ©cnicas mapeadas
  - 4 notas importantes

================================================================================
FIM DO ARQUIVO LÃ‚MPADA
================================================================================
