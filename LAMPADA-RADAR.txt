================================================================================
üí° L√ÇMPADA RADAR - OBSERVA√á√ïES E PEND√äNCIAS
================================================================================
Vers√£o: 2.1
√öltima atualiza√ß√£o: 02/12/2025 00:10 (UTC-5)
Respons√°vel: Equipe Radar Narcisista

================================================================================
üéâ PROGRESSO RECENTE
================================================================================

BLOCO 26-30 INICIADO (02/12/2025):
- ‚úÖ ETAPA 26: Template de resumo + checklist + regras de linguagem
- üîÑ ETAPA 27: ORACULO_V2_CORE (n√∫cleo reutiliz√°vel) ‚Üí PR√ìXIMA
- ‚è≥ ETAPA 28: Infra multiperfil do Or√°culo
- ‚è≥ ETAPA 29: Or√°culo V2 para novos perfis
- ‚è≥ ETAPA 30: Integra√ß√£o com Gerador de SaaS

ETAPAS 40-44 CONCLU√çDAS (01/12/2025):
- ‚úÖ Documenta√ß√£o interativa da API (/docs/api)
- ‚úÖ Testes automatizados com Vitest
- ‚úÖ Dashboard Analytics avan√ßado
- ‚úÖ Sistema de alertas autom√°ticos
- ‚úÖ Exporta√ß√£o de relat√≥rios (CSV, JSON, PDF)
- ‚úÖ Builder.io instalado
- Build atual: 171 p√°ginas

================================================================================
üìã O QUE √â ESTE ARQUIVO?
================================================================================

A "L√¢mpada" √© um documento vivo que consolida:
- üêõ BUGS conhecidos que ainda n√£o foram corrigidos
- ü§î CONFUS√ïES que precisam ser esclarecidas
- ‚öñÔ∏è DECIS√ïES t√©cnicas ou de produto tomadas
- üí° IDEIAS para o futuro (n√£o implementar agora)
- ‚ö†Ô∏è D√çVIDAS T√âCNICAS acumuladas
- üìù NOTAS importantes para n√£o esquecer

REGRA: Antes de implementar algo novo, consulte este arquivo!

================================================================================
üêõ BUGS CONHECIDOS
================================================================================

[B001] Webhook Stripe para add-ons
----------------------------------------------------------------------
Status: ‚úÖ RESOLVIDO (ETAPA 21)
Prioridade: ALTA
Descri√ß√£o: O webhook de pagamento de add-ons n√£o estava criando registros
           na tabela user_addons ap√≥s pagamento bem-sucedido.
Solu√ß√£o: Webhook atualizado em lib/stripe.ts para detectar mode: 'payment'
         e chamar processAddonPurchase() que insere em user_addons.
Arquivos: lib/stripe.ts
Resolvido em: 01/12/2025

[B002] Tabela user_addons n√£o existe
----------------------------------------------------------------------
Status: ‚úÖ RESOLVIDO (ETAPA 21)
Prioridade: ALTA
Descri√ß√£o: A tabela user_addons precisava ser criada no Supabase para
           armazenar add-ons comprados pelos usu√°rios.
Solu√ß√£o: Migration criada em database/migrate-user-addons.sql com:
         - Tabela user_addons com campos completos
         - RLS para seguran√ßa
         - Fun√ß√µes has_active_addon, get_addon_credits, consume_addon_credit
Arquivos: database/migrate-user-addons.sql
Resolvido em: 01/12/2025

[B004] Migration user_addons pendente de execu√ß√£o
----------------------------------------------------------------------
Status: üü° PENDENTE
Prioridade: ALTA
Descri√ß√£o: A migration database/migrate-user-addons.sql foi criada mas
           ainda n√£o foi executada no Supabase de produ√ß√£o.
Impacto: Webhook vai falhar ao tentar inserir em user_addons.
Workaround: Executar migration manualmente no Supabase SQL Editor.
Arquivos: database/migrate-user-addons.sql
Criado em: 01/12/2025

[B003] Cache de menu admin no localStorage
----------------------------------------------------------------------
Status: üü¢ BAIXA PRIORIDADE
Prioridade: BAIXA
Descri√ß√£o: O menu admin salva ordem no localStorage, mas novas features
           podem n√£o aparecer automaticamente para admins existentes.
Impacto: Admin pode n√£o ver novas telas at√© limpar cache.
Workaround: Bot√£o "Limpar cache de IA" no sidebar.
Arquivos: lib/admin-menu-config.ts
Criado em: 01/12/2025

================================================================================
ü§î CONFUS√ïES A ESCLARECER
================================================================================

[C001] Diferen√ßa entre /dashboard e /dashboard-v2
----------------------------------------------------------------------
Status: ‚úÖ RESOLVIDO (ETAPA 17)
Descri√ß√£o: Havia confus√£o sobre qual dashboard era o principal.
Decis√£o: /dashboard √© o principal (Trilha do Her√≥i).
         /dashboard-v2 e /dashboard-premium redirecionam para /dashboard.

[C002] Onde ficam as configura√ß√µes de IA?
----------------------------------------------------------------------
Status: ‚úÖ DOCUMENTADO
Descri√ß√£o: M√∫ltiplas telas de configura√ß√£o de IA causavam confus√£o.
Decis√£o: 
  - /admin = Config IAs (vis√£o geral)
  - /admin/configurar-ias = API Keys
  - /admin/gerenciar-ias = Adicionar novas IAs
  - /admin/custos-ia = Monitorar gastos
  - /admin/mapa-ias = Sa√∫de das IAs

[C003] Qual √© a fonte da verdade do projeto?
----------------------------------------------------------------------
Status: ‚úÖ DOCUMENTADO
Descri√ß√£o: D√∫vida sobre qual arquivo consultar primeiro.
Decis√£o:
  1. TUDO PARA O GPT.txt - Hist√≥rico completo
  2. ATLAS-RADAR-NARCISISTA.txt - Mapa t√©cnico
  3. ROADMAP-RADAR.txt - Roadmap e etapas
  4. TESTES-RADAR.txt - Checklist de testes
  5. LAMPADA-RADAR.txt - Este arquivo (observa√ß√µes)

================================================================================
‚öñÔ∏è DECIS√ïES TOMADAS
================================================================================

[D001] Stack tecnol√≥gica
----------------------------------------------------------------------
Data: 28/11/2025
Decis√£o: Next.js 16 + Supabase + Stripe + TailwindCSS 4
Motivo: Stack moderna, serverless, f√°cil de escalar.
Alternativas descartadas: Firebase, Prisma, MongoDB.

[D002] Modelo de neg√≥cio
----------------------------------------------------------------------
Data: 28/11/2025
Decis√£o: Freemium B2C + Plano Profissional B2B
Motivo: Alcan√ßar v√≠timas (gratuito) + monetizar via profissionais.
Planos: Gratuito, Essencial, Avan√ßado, Premium, Profissional.

[D003] Or√°culo como primeiro item do menu admin
----------------------------------------------------------------------
Data: 01/12/2025
Decis√£o: Or√°culo (defaultOrder: 0) √© o primeiro item do menu.
Motivo: Vis√£o executiva deve ser o ponto de entrada do admin.
Arquivos: app/admin/admin-features-registry.ts

[D004] Termos Aceitos no final do menu
----------------------------------------------------------------------
Data: 01/12/2025
Decis√£o: Termos Aceitos (defaultOrder: 50) fica no final.
Motivo: √Årea sens√≠vel, n√£o deve ser acessada acidentalmente.
Arquivos: app/admin/admin-features-registry.ts

[D005] Dashboards unificados
----------------------------------------------------------------------
Data: 01/12/2025
Decis√£o: 
  - Usu√°ria: /dashboard (Trilha do Her√≥i)
  - Profissional: /dashboard-profissional
  - Legados redirecionam automaticamente
Motivo: Evitar confus√£o e manter UX consistente.

[D006] Estrutura de billing de add-ons
----------------------------------------------------------------------
Data: 01/12/2025
Decis√£o:
  - Tabela user_addons com addon_key correspondendo ao id em addons-config.ts
  - Webhook Stripe detecta mode: 'payment' para add-ons
  - Cr√©ditos gerenciados por credits_total e credits_remaining
  - Expira√ß√£o via expires_at (NULL = permanente)
Motivo: Fluxo consistente entre Stripe, banco e app.
Arquivos: database/migrate-user-addons.sql, lib/stripe.ts, lib/user-addons.ts

================================================================================
üí° IDEIAS PARA O FUTURO (N√ÉO IMPLEMENTAR AGORA)
================================================================================

[I001] App mobile nativo
----------------------------------------------------------------------
Prioridade: M√âDIA
Descri√ß√£o: Criar app React Native para iOS e Android.
Benef√≠cio: Melhor UX, notifica√ß√µes push, modo offline.
Depend√™ncias: MVP est√°vel, valida√ß√£o de mercado.
Estimativa: 3-6 meses.

[I002] Integra√ß√£o com WhatsApp
----------------------------------------------------------------------
Prioridade: ALTA
Descri√ß√£o: Permitir que usu√°rias interajam via WhatsApp.
Benef√≠cio: Canal mais acess√≠vel, menor barreira de entrada.
Depend√™ncias: API do WhatsApp Business, custos.
Estimativa: 1-2 meses.

[I003] Gamifica√ß√£o avan√ßada
----------------------------------------------------------------------
Prioridade: BAIXA
Descri√ß√£o: Adicionar conquistas, n√≠veis, recompensas.
Benef√≠cio: Aumentar engajamento e reten√ß√£o.
Depend√™ncias: M√©tricas de uso est√°veis.
Estimativa: 1 m√™s.

[I004] Comunidade moderada
----------------------------------------------------------------------
Prioridade: M√âDIA
Descri√ß√£o: F√≥rum/chat entre usu√°rias com modera√ß√£o.
Benef√≠cio: Suporte entre pares, senso de comunidade.
Depend√™ncias: Sistema de modera√ß√£o, pol√≠ticas claras.
Estimativa: 2-3 meses.

[I005] IA de voz
----------------------------------------------------------------------
Prioridade: BAIXA
Descri√ß√£o: Permitir intera√ß√£o por voz com o Coach.
Benef√≠cio: Acessibilidade, conveni√™ncia.
Depend√™ncias: Whisper API, custos de transcri√ß√£o.
Estimativa: 1 m√™s.

[I006] Relat√≥rio para advogados
----------------------------------------------------------------------
Prioridade: ALTA
Descri√ß√£o: Gerar relat√≥rio formatado para uso em processos.
Benef√≠cio: Valor agregado para profissionais, diferencial.
Depend√™ncias: Valida√ß√£o jur√≠dica, templates.
Estimativa: 2 semanas.

[I007] üí° OR√ÅCULO V2 MULTIPERFIL (BLOCO 26-30) ‚Äì PATCH OFICIAL
----------------------------------------------------------------------
Prioridade: ALTA (para o BLOCO 26-30)
Status: ‚è≥ FUTURO EXPL√çCITO (n√£o implementar antes do BLOCO 26)

Descri√ß√£o: 
  Expandir o uso do OR√ÅCULO V2 para TODOS os perfis:
  - user_role = "usuaria"
  - user_role = "profissional"
  - user_role = "admin" (j√° funciona no BLOCO 21-25)
  - user_role = "dev"
  - user_role = "whitelabel"

Benef√≠cio: IA de suporte unificada para todo o produto.

Depend√™ncias: 
  - ‚úÖ ETAPA 22 (Or√°culo V2 para admin) conclu√≠da
  - ‚è≥ Feature flags por perfil/plano
  - ‚è≥ Controle de risco por perfil
  - ‚è≥ Atualiza√ß√£o de manuais

Estimativa: BLOCO 26-30.

M√≥dulo ORACULO_V2_CORE:
  - Unificar em m√≥dulo reutiliz√°vel
  - Acopl√°vel ao GERADOR DE SAAS
  - Todo SaaS gerado pode nascer com Or√°culo embutido

IMPORTANTE (PATCH OR√ÅCULO):
  - Ver docs/PATCH-ORACULO.md para regras completas
  - BLOCO 21-25: Or√°culo V2 √© S√ì PARA ADMIN
  - BLOCO 26-30: Abertura para outros perfis

================================================================================
‚ö†Ô∏è D√çVIDAS T√âCNICAS
================================================================================

[T001] Testes automatizados
----------------------------------------------------------------------
Status: üü° PENDENTE
Descri√ß√£o: N√£o h√° testes unit√°rios ou E2E implementados.
Impacto: Risco de regress√µes em deploys.
Solu√ß√£o: Implementar Jest + Playwright.
Estimativa: 1 semana.

[T002] Documenta√ß√£o de APIs
----------------------------------------------------------------------
Status: üü° PENDENTE
Descri√ß√£o: APIs n√£o t√™m documenta√ß√£o Swagger/OpenAPI.
Impacto: Dificulta integra√ß√µes e onboarding de devs.
Solu√ß√£o: Adicionar swagger-ui ou similar.
Estimativa: 2-3 dias.

[T003] Logs estruturados
----------------------------------------------------------------------
Status: üü° PENDENTE
Descri√ß√£o: Logs s√£o console.log simples, sem estrutura.
Impacto: Dif√≠cil debugar em produ√ß√£o.
Solu√ß√£o: Implementar Pino ou Winston.
Estimativa: 1 dia.

[T004] Monitoramento de erros
----------------------------------------------------------------------
Status: üü° PENDENTE
Descri√ß√£o: N√£o h√° Sentry ou similar configurado.
Impacto: Erros em produ√ß√£o podem passar despercebidos.
Solu√ß√£o: Configurar Sentry.
Estimativa: 2 horas.

[T005] Rate limiting
----------------------------------------------------------------------
Status: üü° PENDENTE
Descri√ß√£o: APIs n√£o t√™m rate limiting implementado.
Impacto: Vulner√°vel a abuso e DDoS.
Solu√ß√£o: Implementar rate limiting no middleware.
Estimativa: 1 dia.

================================================================================
üìù NOTAS IMPORTANTES
================================================================================

[N001] Credenciais de produ√ß√£o
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Todas as credenciais de produ√ß√£o est√£o no Vercel.
      NUNCA commitar .env.local com chaves reais.
      Stripe est√° em modo TESTE at√© lan√ßamento.

[N002] Backup do banco
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Supabase faz backup autom√°tico di√°rio.
      Para restore, acessar Supabase Dashboard > Backups.

[N003] Deploy autom√°tico
----------------------------------------------------------------------
Data: 01/12/2025
Nota: Push para main = deploy autom√°tico no Vercel.
      Verificar build antes de fazer push.
      URL: https://vercel.com/radar-narcisista-brs-projects

[N004] Contatos de emerg√™ncia
----------------------------------------------------------------------
Data: 01/12/2025
Nota: 
  - Eduardo (dev): [email]
  - Suporte Vercel: vercel.com/support
  - Suporte Supabase: supabase.com/support
  - Suporte Stripe: stripe.com/support

================================================================================
üìä M√âTRICAS DE SA√öDE DO PROJETO
================================================================================

√öltima verifica√ß√£o: 01/12/2025 21:45

| M√©trica                  | Valor    | Status |
|--------------------------|----------|--------|
| Etapas conclu√≠das        | 31/35    | ‚úÖ     |
| Bloco atual              | 31-35    | üîÑ     |
| Build passando           | Sim      | ‚úÖ     |
| P√°ginas geradas          | 163      | ‚úÖ     |
| Bugs cr√≠ticos            | 0        | ‚úÖ     |
| D√≠vidas t√©cnicas         | 5        | üü°     |
| Documenta√ß√£o atualizada  | Sim      | ‚úÖ     |
| √öltimo deploy            | Hoje     | ‚úÖ     |

================================================================================
üîÑ HIST√ìRICO DE ATUALIZA√á√ïES DESTE ARQUIVO
================================================================================

01/12/2025 21:30 - ETAPA 30 (INTEGRA√á√ÉO GERADOR DE SAAS + QA)
  - docs/ORACULO-CORE-SAAS.md criado (guia de integra√ß√£o)
  - lib/__tests__/oraculo-core.test.ts criado (testes unit√°rios)
  - M√©tricas atualizadas: 30/32 etapas
  - üéâ BLOCO 26-30 CONCLU√çDO!

01/12/2025 21:00 - ETAPA 29 (EXPOR OR√ÅCULO V2 PARA OUTROS PERFIS)
  - components/OraculoMultiperfil.tsx criado
  - components/OraculoHint.tsx criado
  - Suporta todos os perfis: admin, usuaria, profissional, dev, whitelabel

01/12/2025 20:30 - ETAPA 28 (INFRA MULTIPERFIL)
  - database/migrate-oraculo-settings.sql criado
  - lib/oraculo-settings.ts criado
  - /api/oraculo-v2 integrado com verifica√ß√£o de limites

01/12/2025 20:00 - ETAPA 27 (ORACULO_V2_CORE)
  - lib/oraculo-core.ts criado (n√∫cleo reutiliz√°vel)
  - Prompts por perfil: admin, usuaria, profissional, dev, whitelabel
  - /api/oraculo-v2 refatorado para usar o core
  - docs/ORACULO-CORE.md criado

01/12/2025 19:30 - ETAPA 26 (Template de Resumo + Checklist + Regras)
  - BLOCO 26-30 INICIADO!
  - docs/FORMATO-RESUMO-ETAPAS.md atualizado (v2.0)
  - docs/CHECKLIST-RESUMO-IA.md criado
  - docs/PATCHES-ORACULO-COMPLETO.md criado
  - scripts/validar-resumo-ia.ts criado

01/12/2025 18:00 - ETAPA 25 (QA T√©cnico + Checklist P√≥s-MVP)
  - CHECKLIST-POS-MVP.md criado
  - M√©tricas atualizadas: 24/25 etapas, 163 p√°ginas
  - üéâ BLOCO 21-25 CONCLU√çDO!

01/12/2025 17:00 - ETAPA 24 (Manuais & Links Internos)
  - Todos os 5 manuais atualizados com links

01/12/2025 16:00 - ETAPA 23 (Seguran√ßa T√©cnica)
  - Rate limiting e logger implementados
  - /api/health criado

01/12/2025 15:30 - ETAPA 22 (Or√°culo V2)
  - API e componente do Or√°culo V2 criados

01/12/2025 15:00 - ETAPA 21 (Billing S√≥lido & Add-ons)
  - B001 e B002 resolvidos (webhook e tabela user_addons)
  - B004 adicionado (migration pendente de execu√ß√£o)
  - D006 adicionada (estrutura de billing de add-ons)
  - I007 adicionada (Or√°culo V2 Multiperfil para BLOCO 26-30)
  - M√©tricas atualizadas: 21/25 etapas, 161 p√°ginas

01/12/2025 13:30 - Cria√ß√£o inicial (ETAPA 20)
  - Estrutura base com 6 se√ß√µes
  - 3 bugs conhecidos documentados
  - 3 confus√µes esclarecidas
  - 5 decis√µes registradas
  - 6 ideias para o futuro
  - 5 d√≠vidas t√©cnicas mapeadas
  - 4 notas importantes

================================================================================
FIM DO ARQUIVO L√ÇMPADA
================================================================================
